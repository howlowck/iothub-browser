!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.iothubBrowser=e():t.iothubBrowser=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=108)}([function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){var r=n(3),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,e),e.Buffer=s),o(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var c,h=[],u=!1,l=-1;function f(){u&&c&&(u=!1,c.length?h=c.concat(h):l=-1,h.length&&p())}function p(){if(!u){var t=a(f);u=!0;for(var e=h.length;e;){for(c=h,h=[];++l<e;)c&&c[l].run();l=-1,e=h.length}c=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function _(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new d(t,e)),1!==h.length||u||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(56),i=n(57),o=n(29);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return h(this,t,e,n)}function h(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=a(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|p(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?a(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(u(e),t=a(t,e<0?0:0|p(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|p(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return D(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(t).length;default:if(r)return D(t).length;e=(""+e).toLowerCase(),r=!0}}function _(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,i);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,r,i){var o,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function h(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var u=-1;for(o=n;o<a;o++)if(h(t,o)===h(e,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===c)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){for(var l=!0,f=0;f<c;f++)if(h(t,o+f)!==h(e,f)){l=!1;break}if(l)return o}return-1}function g(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function v(t,e,n,r){return z(D(e,t.length-n),t,n,r)}function b(t,e,n,r){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return b(t,e,n,r)}function E(t,e,n,r){return z(F(e),t,n,r)}function S(t,e,n,r){return z(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function k(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function x(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,c,h=t[i],u=null,l=h>239?4:h>223?3:h>191?2:1;if(i+l<=n)switch(l){case 1:h<128&&(u=h);break;case 2:128==(192&(o=t[i+1]))&&(c=(31&h)<<6|63&o)>127&&(u=c);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(c=(15&h)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&h)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(u=c)}null===u?(u=65533,l=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=l}return function(t){var e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=I));return n}(r)}e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return h(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,r){return u(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return l(null,t)},c.allocUnsafeSlow=function(t){return l(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)_(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)_(this,e,e+3),_(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)_(this,e,e+7),_(this,e+1,e+6),_(this,e+2,e+5),_(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?x(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,n);case"utf8":case"utf-8":return x(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return T(this,e,n);case"base64":return k(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,i){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,s=n-e,a=Math.min(o,s),h=this.slice(r,i),u=t.slice(e,n),l=0;l<a;++l)if(h[l]!==u[l]){o=h[l],s=u[l];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return g(this,t,e,n);case"utf8":case"utf-8":return v(this,t,e,n);case"ascii":return b(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return E(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function T(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function C(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=q(t[o]);return i}function O(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function U(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function P(t,e,n,r,i,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function R(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function M(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function B(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(t,e,n,r,o){return o||B(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function L(t,e,n,r,o){return o||B(t,0,n,8),i.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var i=e-t;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||U(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||U(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},c.prototype.readUInt8=function(t,e){return e||U(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||U(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||U(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||U(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||U(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||U(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||U(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},c.prototype.readInt8=function(t,e){return e||U(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||U(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||U(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||U(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||U(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||U(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||U(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||U(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||U(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||P(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||P(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):M(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);P(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);P(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):M(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return j(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return j(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},c.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=c.isBuffer(t)?t:D(new c(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function q(t){return t<16?"0"+t.toString(16):t.toString(16)}function D(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function F(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(N,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(5))},function(t,e,n){(function(e){var r,i=n(11),o=n(54),s=n(55),a=Array.prototype.slice,c={};r=void 0!==e&&e.console?e.console:"undefined"!=typeof window&&window.console?window.console:{};for(var h=[[function(){},"log"],[function(){r.log.apply(r,arguments)},"info"],[function(){r.log.apply(r,arguments)},"warn"],[function(){r.warn.apply(r,arguments)},"error"],[function(t){c[t]=s()},"time"],[function(t){var e=c[t];if(!e)throw new Error("No such label: "+t);var n=s()-e;r.log(t+": "+n+"ms")},"timeEnd"],[function(){var t=new Error;t.name="Trace",t.message=i.format.apply(null,arguments),r.error(t.stack)},"trace"],[function(t){r.log(i.inspect(t)+"\n")},"dir"],[function(t){if(!t){var e=a.call(arguments,1);o.ok(!1,i.format.apply(null,e))}},"assert"]],u=0;u<h.length;u++){var l=h[u],f=l[0],p=l[1];r[p]||(r[p]=f)}t.exports=r}).call(this,n(5))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,s,a,c,h;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}if(o(n=this._events[t]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(i(n))for(a=Array.prototype.slice.call(arguments,1),s=(h=n.slice()).length,c=0;c<s;c++)h[c].apply(this,a);return!0},n.prototype.addListener=function(t,s){var a;if(!r(s))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(s.listener)?s.listener:s),this._events[t]?i(this._events[t])?this._events[t].push(s):this._events[t]=[this._events[t],s]:this._events[t]=s,i(this._events[t])&&!this._events[t].warned&&(a=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[t].length>a&&(this._events[t].warned=!0,e.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof e.trace&&e.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){if(!r(e))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},n.prototype.removeListener=function(t,e){var n,o,s,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(n=this._events[t]).length,o=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(n)){for(a=s;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}}).call(this,n(4))},function(t,e,n){"use strict";(function(t){n.d(e,"d",function(){return o}),n.d(e,"c",function(){return s}),n.d(e,"a",function(){return a}),n.d(e,"e",function(){return c}),n.d(e,"b",function(){return h});var r=n(50),i=n.n(r);const o=t=>Math.ceil(Date.now()/1e3+60*t),s=t=>{return"SharedAccessSignature "+["sr","sig","se","skn"].map(e=>t[e]?e+"="+t[e]:null,"").filter(t=>t).join("&")},a=(e,n,r,o)=>{const s=encodeURIComponent(e),a={_key:r,sr:s,se:o,sig:((e,n,r)=>{const o=e+"\n"+r,s=i()("sha256",new t(n,"base64"));s.update(o);const a=s.digest("base64");return encodeURIComponent(a)})(s,r,o)};return n&&(a.skn=n),a},c=t=>t.split(";").reduce((t,e,n)=>{const r=e.search("="),i=e.slice(0,r),o=e.slice(r+1);return t[i]=o,t},{}),h=t=>t.slice(5,-1)}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){var r=n(52),i=n(14),o=n(63),s=n(30),a=n(21),c=n(70),h=n(20),u=n(20),l=n(6).EventEmitter,f=function(t){this.options=t?Object.create(t):{},this.options.id||(this.options.id=a.generate_uuid()),this.id=this.options.id,this.sasl_server_mechanisms=s.server_mechanisms()};(f.prototype=Object.create(l.prototype)).constructor=f,f.prototype.dispatch=function(t){return i.events("Container got event: "+t),l.prototype.emit.apply(this,arguments),!!this.listeners(t).length},f.prototype.connect=function(t){return new r(t,this).connect()},f.prototype.create_connection=function(t){return new r(t,this)},f.prototype.listen=function(t){var n,i=this;if(void 0===t.transport||"tcp"===t.transport)(n=h.createServer()).on("connection",function(e){new r(t,i).accept(e)});else{if("tls"!==t.transport&&"ssl"!==t.transport)throw Error("Unrecognised transport: "+t.transport);(n=u.createServer(t)).on("secureConnection",function(e){new r(t,i).accept(e)})}return e.version.match(/v0\.10\.\d+/)?n.listen(t.port,t.host):n.listen(t),n},f.prototype.create_container=function(t){return new f(t)},f.prototype.get_option=function(t,e){return void 0!==this.options[t]?this.options[t]:e},f.prototype.generate_uuid=a.generate_uuid,f.prototype.string_to_uuid=a.string_to_uuid,f.prototype.uuid_to_string=a.uuid_to_string,f.prototype.rpc_server=function(t,e){return o.server(this,t,e)},f.prototype.rpc_client=function(t){return o.client(this,t)};var p=n(71);f.prototype.websocket_accept=function(t,e){new r(e,this).accept(p.wrap(t))},f.prototype.websocket_connect=p.connect,f.prototype.filter=n(72),f.prototype.types=n(13),f.prototype.message=n(23),f.prototype.sasl=s,f.prototype.ReceiverEvents=c.ReceiverEvents,f.prototype.SenderEvents=c.SenderEvents,f.prototype.SessionEvents=c.SessionEvents,f.prototype.ConnectionEvents=c.ConnectionEvents,t.exports=new f}).call(this,n(2))},function(t,e,n){(e=t.exports=n(34)).Stream=e,e.Readable=e,e.Writable=n(25),e.Duplex=n(10),e.Transform=n(37),e.PassThrough=n(80)},function(t,e,n){"use strict";var r=n(17),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=l;var o=n(18);o.inherits=n(0);var s=n(34),a=n(25);o.inherits(l,s);for(var c=i(a.prototype),h=0;h<c.length;h++){var u=c[h];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(t){if(!(this instanceof l))return new l(t);s.call(this,t),a.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||r.nextTick(p,this)}function p(t){t.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),l.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},function(t,e,n){(function(t,r,i){var o=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(c(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(o,function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),a=r[n];n<i;a=r[++n])m(a)||!w(a)?s+=" "+a:s+=" "+c(a);return s},e.deprecate=function(n,o){if(v(t.process))return function(){return e.deprecate(n,o).apply(this,arguments)};if(!0===r.noDeprecation)return n;var s=!1;return function(){if(!s){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?i.trace(o):i.error(o),s=!0}return n.apply(this,arguments)}};var s,a={};function c(t,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),_(n)?r.showHidden=n:n&&e._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=h),l(r,t,r.depth)}function h(t,e){var n=c.styles[e];return n?"["+c.colors[n][0]+"m"+t+"["+c.colors[n][1]+"m":t}function u(t,e){return t}function l(t,n,r){if(t.customInspect&&n&&k(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return g(i)||(i=l(t,i,r)),i}var o=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(y(e))return t.stylize(""+e,"number");if(_(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,n);if(o)return o;var s=Object.keys(n),a=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),S(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(n);if(0===s.length){if(k(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return t.stylize(Date.prototype.toString.call(n),"date");if(S(n))return f(n)}var h,u="",w=!1,x=["{","}"];(d(n)&&(w=!0,x=["[","]"]),k(n))&&(u=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(u=" "+RegExp.prototype.toString.call(n)),E(n)&&(u=" "+Date.prototype.toUTCString.call(n)),S(n)&&(u=" "+f(n)),0!==s.length||w&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),h=w?function(t,e,n,r,i){for(var o=[],s=0,a=e.length;s<a;++s)T(e,String(s))?o.push(p(t,e,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(t,e,n,r,i,!0))}),o}(t,n,r,a,s):s.map(function(e){return p(t,n,r,a,e,w)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(h,u,x)):x[0]+u+x[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,r,i,o){var s,a,c;if((c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),T(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(c.value)<0?(a=m(n)?l(t,c.value,null):l(t,c.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),v(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function d(t){return Array.isArray(t)}function _(t){return"boolean"==typeof t}function m(t){return null===t}function y(t){return"number"==typeof t}function g(t){return"string"==typeof t}function v(t){return void 0===t}function b(t){return w(t)&&"[object RegExp]"===x(t)}function w(t){return"object"==typeof t&&null!==t}function E(t){return w(t)&&"[object Date]"===x(t)}function S(t){return w(t)&&("[object Error]"===x(t)||t instanceof Error)}function k(t){return"function"==typeof t}function x(t){return Object.prototype.toString.call(t)}function I(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(v(s)&&(s=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(s)){var n=r.pid;a[t]=function(){var r=e.format.apply(e,arguments);i.error("%s %d: %s",t,n,r)}}else a[t]=function(){};return a[t]},e.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=_,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=b,e.isObject=w,e.isDate=E,e.isError=S,e.isFunction=k,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(53);var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){i.log("%s - %s",function(){var t=new Date,e=[I(t.getHours()),I(t.getMinutes()),I(t.getSeconds())].join(":");return[t.getDate(),A[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(0),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,n(5),n(2),n(4))},function(t,e,n){"use strict";var r=n(11);function i(t){Error.call(this),this.message=t,this.name="ProtocolError"}function o(t){i.call(this,t),this.message=t,this.name="TypeError"}function s(t,e,n){Error.call(this,t),this.message=t,this.name="ConnectionError",this.condition=e,this.description=t,this.connection=n}r.inherits(i,Error),r.inherits(o,i),r.inherits(s,Error),s.prototype.toJSON=function(){return{type:this.name,code:this.condition,message:this.description}},t.exports={ProtocolError:i,TypeError:o,ConnectionError:s}},function(t,e,n){"use strict";(function(e,r){var i=n(12),o=1,s=2,a=3,c=4;function h(t,e,n,r){this.type=t,this.value=e,n&&(this.array_constructor={typecode:n},r&&(this.array_constructor.descriptor=r))}function u(t,e,n,r){this.name=t,this.typecode=e;var i=e>>>4;switch(i){case 4:this.width=0,this.category=o;break;case 5:this.width=1,this.category=o;break;case 6:this.width=2,this.category=o;break;case 7:this.width=4,this.category=o;break;case 8:this.width=8,this.category=o;break;case 9:this.width=16,this.category=o;break;case 10:this.width=1,this.category=s;break;case 11:this.width=4,this.category=s;break;case 12:this.width=1,this.category=a;break;case 13:this.width=4,this.category=a;break;case 14:this.width=1,this.category=c;break;case 15:this.width=4,this.category=c}n&&(n.read&&(this.read=n.read),n.write&&(this.write=n.write),n.encoding&&(this.encoding=n.encoding));var u=this;this.create=4===i?function(){return new h(u,r)}:14===i||15===i?function(t,e,n){return new h(u,t,e,n)}:function(t){return new h(u,t)}}function l(t){return Number(t).toString(16)}h.prototype.toString=function(){return this.value?this.value.toString():null},h.prototype.toLocaleString=function(){return this.value?this.value.toLocaleString():null},h.prototype.valueOf=function(){return this.value},h.prototype.toJSON=function(){return this.value&&this.value.toJSON?this.value.toJSON():this.value},u.prototype.toString=function(){return this.name+"#"+l(this.typecode)};var f={by_code:{}};function p(t,e,n,r){var i=new u(t,e,n,r);i.create.typecode=i.typecode,f.by_code[i.typecode]=i,f[t]=i.create}Object.defineProperty(f,"MAX_UINT",{value:4294967295,writable:!1,configurable:!1}),Object.defineProperty(f,"MAX_USHORT",{value:65535,writable:!1,configurable:!1});var d=4294967296;function _(t,e,n){if("number"==typeof e||e instanceof Number){var r=Math.abs(e),i=Math.floor(r/d),o=r%d;if(t.writeInt32BE(i,n),t.writeUInt32BE(o,n+4),e<0)for(var s=1,a=0;a<8;a++){var c=n+(7-a),h=(255^t[c])+s;t[c]=255&h,s=h>>8}}else e.copy(t,n)}function m(t,e){var n=t.readInt32BE(e),r=t.readUInt32BE(e+4);return n<2097153&&n>-2097153?n*d+r:t.slice(e,e+8)}function y(t,e){for(var n=0;n<e.length;n++)if(t.type.typecode===e[n].typecode)return!0;return!1}function g(t,e,n){for(var r=0;r<e&&r<t.length;r++)if(t[r]!==(n?255:0))return!1;return!0}function v(t){for(var e={},n=0;n+1<t.length;)e[t[n++]]=t[n++];return e}p("Null",64,void 0,null),p("Boolean",86,{read:function(t,e){return t.readUInt8(e)},write:function(t,e,n){t.writeUInt8(e,n)}}),p("True",65,void 0,!0),p("False",66,void 0,!1),p("Ubyte",80,{read:function(t,e){return t.readUInt8(e)},write:function(t,e,n){t.writeUInt8(e,n)}}),p("Ushort",96,{read:function(t,e){return t.readUInt16BE(e)},write:function(t,e,n){t.writeUInt16BE(e,n)}}),p("Uint",112,{read:function(t,e){return t.readUInt32BE(e)},write:function(t,e,n){t.writeUInt32BE(e,n)}}),p("SmallUint",82,{read:function(t,e){return t.readUInt8(e)},write:function(t,e,n){t.writeUInt8(e,n)}}),p("Uint0",67,void 0,0),p("Ulong",128,{write:function(t,e,n){if("number"==typeof e||e instanceof Number){var r=Math.floor(e/d),i=e%d;t.writeUInt32BE(r,n),t.writeUInt32BE(i,n+4)}else e.copy(t,n)},read:function(t,e){var n=t.readUInt32BE(e),r=t.readUInt32BE(e+4);return n<2097153?n*d+r:t.slice(e,e+8)}}),p("SmallUlong",83,{read:function(t,e){return t.readUInt8(e)},write:function(t,e,n){t.writeUInt8(e,n)}}),p("Ulong0",68,void 0,0),p("Byte",81,{read:function(t,e){return t.readInt8(e)},write:function(t,e,n){t.writeInt8(e,n)}}),p("Short",97,{read:function(t,e){return t.readInt16BE(e)},write:function(t,e,n){t.writeInt16BE(e,n)}}),p("Int",113,{read:function(t,e){return t.readInt32BE(e)},write:function(t,e,n){t.writeInt32BE(e,n)}}),p("SmallInt",84,{read:function(t,e){return t.readInt8(e)},write:function(t,e,n){t.writeInt8(e,n)}}),p("Long",129,{write:_,read:m}),p("SmallLong",85,{read:function(t,e){return t.readInt8(e)},write:function(t,e,n){t.writeInt8(e,n)}}),p("Float",114,{read:function(t,e){return t.readFloatBE(e)},write:function(t,e,n){t.writeFloatBE(e,n)}}),p("Double",130,{read:function(t,e){return t.readDoubleBE(e)},write:function(t,e,n){t.writeDoubleBE(e,n)}}),p("Decimal32",116),p("Decimal64",132),p("Decimal128",148),p("CharUTF32",115,{read:function(t,e){return t.readUInt32BE(e)},write:function(t,e,n){t.writeUInt32BE(e,n)}}),p("Timestamp",131,{write:_,read:m}),p("Uuid",152),p("Vbin8",160),p("Vbin32",176),p("Str8",161,{encoding:"utf8"}),p("Str32",177,{encoding:"utf8"}),p("Sym8",163,{encoding:"ascii"}),p("Sym32",179,{encoding:"ascii"}),p("List0",69,void 0,[]),p("List8",192),p("List32",208),p("Map8",193),p("Map32",209),p("Array8",224),p("Array32",240),f.is_ulong=function(t){return y(t,[f.Ulong,f.Ulong0,f.SmallUlong])},f.is_string=function(t){return y(t,[f.Str8,f.Str32])},f.is_symbol=function(t){return y(t,[f.Sym8,f.Sym32])},f.is_list=function(t){return y(t,[f.List0,f.List8,f.List32])},f.is_map=function(t){return y(t,[f.Map8,f.Map32])},f.wrap_boolean=function(t){return t?f.True():f.False()},f.wrap_ulong=function(t){return e.isBuffer(t)?g(t,8,!1)?f.Ulong0():g(t,7,!1)?f.SmallUlong(t[7]):f.Ulong(t):0===t?f.Ulong0():t>255?f.Ulong(t):f.SmallUlong(t)},f.wrap_uint=function(t){return 0===t?f.Uint0():t>255?f.Uint(t):f.SmallUint(t)},f.wrap_ushort=function(t){return f.Ushort(t)},f.wrap_ubyte=function(t){return f.Ubyte(t)},f.wrap_long=function(t){if(e.isBuffer(t)){var n=0!=(128&t[0]);return g(t,7,n)&&(128&t[7])==(n?128:0)?f.SmallLong(n?-(1+(255^t[7])):t[7]):f.Long(t)}return t>127||t<-128?f.Long(t):f.SmallLong(t)},f.wrap_int=function(t){return t>127||t<-128?f.Int(t):f.SmallInt(t)},f.wrap_short=function(t){return f.Short(t)},f.wrap_byte=function(t){return f.Byte(t)},f.wrap_float=function(t){return f.Float(t)},f.wrap_double=function(t){return f.Double(t)},f.wrap_timestamp=function(t){return f.Timestamp(t)},f.wrap_char=function(t){return f.CharUTF32(t)},f.wrap_uuid=function(t){return f.Uuid(t)},f.wrap_binary=function(t){return t.length>255?f.Vbin32(t):f.Vbin8(t)},f.wrap_string=function(t){return t.length>255?f.Str32(t):f.Str8(t)},f.wrap_symbol=function(t){return t.length>255?f.Sym32(t):f.Sym8(t)},f.wrap_list=function(t){if(0===t.length)return f.List0();var e=t.map(f.wrap);return f.List32(e)},f.wrap_map=function(t,e){var n=[];for(var r in t)n.push(e?e(r):f.wrap(r)),n.push(f.wrap(t[r]));return f.Map32(n)},f.wrap_symbolic_map=function(t){return f.wrap_map(t,f.wrap_symbol)},f.wrap_array=function(t,e,n){if(e)return f.Array32(t,e,n);throw r.trace("An array must specify a type for its elements"),new i.TypeError("An array must specify a type for its elements")},f.wrap=function(t){var n=typeof t;if("string"===n)return f.wrap_string(t);if("boolean"===n)return t?f.True():f.False();if("number"===n||t instanceof Number){if(isNaN(t))throw new i.TypeError("Cannot wrap NaN! "+t);return Math.floor(t)-t!=0?f.Double(t):t>0?t<d?f.wrap_uint(t):f.wrap_ulong(t):t>-2147483647?f.wrap_int(t):f.wrap_long(t)}return t instanceof Date?f.wrap_timestamp(t.getTime()):t instanceof h?t:t instanceof e?f.wrap_binary(t):"undefined"===n||null===t?f.Null():Array.isArray(t)?f.wrap_list(t):f.wrap_map(t)},f.wrap_described=function(t,e){var n=f.wrap(t);return e&&("string"==typeof e?n=f.described(f.wrap_string(e),n):("number"==typeof e||e instanceof Number)&&(n=f.described(f.wrap_ulong(e),n))),n},f.wrap_message_id=function(t){var n=typeof t;if("string"===n)return f.wrap_string(t);if("number"===n||t instanceof Number)return f.wrap_ulong(t);if(e.isBuffer(t))return f.wrap_uuid(t);throw new i.TypeError("invalid message id:"+t)};var b={};function w(t){var e=f.by_code[t];if(!e)throw new i.TypeError("Unrecognised typecode: "+l(t));return e}function E(t,e){if(void 0!==e&&null!==e){if(Array.isArray(e)){if(!t.multiple)throw new i.TypeError("Field "+t.name+" does not support multiple values, got "+JSON.stringify(e));var n=function(t){if("symbol"===t)return{typecode:f.Sym8.typecode};throw new i.TypeError("TODO: Array of type "+t+" not yet supported")}(t.type);return f.wrap_array(e,n.typecode,n.descriptor)}if("*"===t.type)return e;var r=f["wrap_"+t.type];if(r)return r(e);throw new i.TypeError("No wrapper for field "+t.name+" of type "+t.type)}if(t.mandatory)throw new i.TypeError("Field "+t.name+" is mandatory");return f.Null()}function S(t,e){return{get:"*"===e.type?function(){return this.value[t]}:function(){return f.unwrap(this.value[t])},set:function(n){this.value[t]=E(e,n)},enumerable:!0,configurable:!1}}f.unwrap_map_simple=function(t){return v(t.value.map(function(t){return f.unwrap(t,!0)}))},f.unwrap=function(t,e){if(t instanceof h){if(t.descriptor){var n=b[t.descriptor.value];if(n)return new n(t.value);if(e)return t}var r=f.unwrap(t.value,!0);return f.is_map(t)?v(r):r}return Array.isArray(t)?t.map(function(t){return f.unwrap(t,!0)}):t},f.described_nc=function(t,e){return t.length?(e.descriptor=t.shift(),f.described(t,e)):(e.descriptor=t,e)},f.described=f.described_nc,f.Reader=function(t){this.buffer=t,this.position=0},f.Reader.prototype.read_typecode=function(){return this.read_uint(1)},f.Reader.prototype.read_uint=function(t){var e=this.position;if(this.position+=t,1===t)return this.buffer.readUInt8(e);if(2===t)return this.buffer.readUInt16BE(e);if(4===t)return this.buffer.readUInt32BE(e);throw new i.TypeError("Unexpected width for uint "+t)},f.Reader.prototype.read_fixed_width=function(t){var e=this.position;return this.position+=t.width,t.read?t.read(this.buffer,e):this.buffer.slice(e,this.position)},f.Reader.prototype.read_variable_width=function(t){var e=this.read_uint(t.width),n=this.read_bytes(e);return t.encoding?n.toString(t.encoding):n},f.Reader.prototype.read=function(){var t=this.read_constructor(),e=this.read_value(w(t.typecode));return t.descriptor?f.described_nc(t.descriptor,e):e},f.Reader.prototype.read_constructor=function(){var t=this.read_typecode();if(0===t){var e=[];e.push(this.read());for(var n=this.read_constructor();n.descriptor;)e.push(n.descriptor),n=this.read_constructor();return{typecode:n.typecode,descriptor:1===e.length?e[0]:e}}return{typecode:t}},f.Reader.prototype.read_value=function(t){if(0===t.width)return t.create();if(t.category===o)return t.create(this.read_fixed_width(t));if(t.category===s)return t.create(this.read_variable_width(t));if(t.category===a)return this.read_compound(t);if(t.category===c)return this.read_array(t);throw new i.TypeError("Invalid category for type: "+t)},f.Reader.prototype.read_array_items=function(t,e){for(var n=[];n.length<t;)n.push(this.read_value(e));return n},f.Reader.prototype.read_n=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=this.read();return e},f.Reader.prototype.read_size_count=function(t){return{size:this.read_uint(t),count:this.read_uint(t)}},f.Reader.prototype.read_compound=function(t){var e=this.read_size_count(t.width);return t.create(this.read_n(e.count))},f.Reader.prototype.read_array=function(t){var e=this.read_size_count(t.width),n=this.read_constructor();return t.create(this.read_array_items(e.count,w(n.typecode)),n.typecode,n.descriptor)},f.Reader.prototype.toString=function(){var t="buffer@"+this.position;this.position&&(t+=": ");for(var e=this.position;e<this.buffer.length;e++)e>0&&(t+=","),t+="0x"+Number(this.buffer[e]).toString(16);return t},f.Reader.prototype.reset=function(){this.position=0},f.Reader.prototype.skip=function(t){this.position+=t},f.Reader.prototype.read_bytes=function(t){var e=this.position;return this.position+=t,this.buffer.slice(e,this.position)},f.Reader.prototype.remaining=function(){return this.buffer.length-this.position},f.Writer=function(t){this.buffer=t||new e(1024),this.position=0},f.Writer.prototype.toBuffer=function(){return this.buffer.slice(0,this.position)},f.Writer.prototype.ensure=function(t){if(this.buffer.length<t){var n=new e(function(t,e){return t>e?t:e}(2*this.buffer.length,t));this.buffer.copy(n),this.buffer=n}},f.Writer.prototype.write_typecode=function(t){this.write_uint(t,1)},f.Writer.prototype.write_uint=function(t,e){var n=this.position;if(this.ensure(this.position+e),this.position+=e,1===e)return this.buffer.writeUInt8(t,n);if(2===e)return this.buffer.writeUInt16BE(t,n);if(4===e)return this.buffer.writeUInt32BE(t,n);throw new i.TypeError("Unexpected width for uint "+e)},f.Writer.prototype.write_fixed_width=function(t,e){var n=this.position;if(this.ensure(this.position+t.width),this.position+=t.width,t.write)t.write(this.buffer,e,n);else{if(!e.copy)throw new i.TypeError("Cannot handle write for "+t);e.copy(this.buffer,n)}},f.Writer.prototype.write_variable_width=function(t,n){var r=t.encoding?new e(n,t.encoding):new e(n);this.write_uint(r.length,t.width),this.write_bytes(r)},f.Writer.prototype.write_bytes=function(t){var e=this.position;this.ensure(this.position+t.length),this.position+=t.length,t.copy(this.buffer,e)},f.Writer.prototype.write_constructor=function(t,e){e&&(this.write_typecode(0),this.write(e)),this.write_typecode(t)},f.Writer.prototype.write=function(t){if(void 0===t.type){if(!t.described)throw new i.TypeError("Cannot write "+JSON.stringify(t));this.write(t.described())}else this.write_constructor(t.type.typecode,t.descriptor),this.write_value(t.type,t.value,t.array_constructor)},f.Writer.prototype.write_value=function(t,e,n){if(0!==t.width)if(t.category===o)this.write_fixed_width(t,e);else if(t.category===s)this.write_variable_width(t,e);else if(t.category===a)this.write_compound(t,e);else{if(t.category!==c)throw new i.TypeError("Invalid category "+t.category+" for type: "+t);this.write_array(t,e,n)}},f.Writer.prototype.backfill_size=function(t,e){var n=this.position-e;this.position=e,this.write_uint(n-t,t),this.position+=n-t},f.Writer.prototype.write_compound=function(t,e){var n=this.position;this.position+=t.width,this.write_uint(e.length,t.width);for(var r=0;r<e.length;r++)void 0===e[r]||null===e[r]?this.write(f.Null()):this.write(e[r]);this.backfill_size(t.width,n)},f.Writer.prototype.write_array=function(t,e,n){var r=this.position;this.position+=t.width,this.write_uint(e.length,t.width),this.write_constructor(n.typecode,n.descriptor);for(var i=w(n.typecode),o=0;o<e.length;o++)this.write_value(i,e[o]);this.backfill_size(t.width,r)},f.Writer.prototype.toString=function(){var t="buffer@"+this.position;this.position&&(t+=": ");for(var e=0;e<this.position;e++)e>0&&(t+=","),t+=("00"+Number(this.buffer[e]).toString(16)).slice(-2);return t},f.Writer.prototype.skip=function(t){this.ensure(this.position+t),this.position+=t},f.Writer.prototype.clear=function(){this.buffer.fill(0),this.position=0},f.Writer.prototype.remaining=function(){return this.buffer.length-this.position},f.define_composite=function(t){var e=function(t){this.value=t||[]};e.descriptor={numeric:t.code,symbolic:"amqp:"+t.name+":list"},e.prototype.dispatch=function(e,n){e["on_"+t.name](n)};for(var n=0;n<t.fields.length;n++){var r=t.fields[n];Object.defineProperty(e.prototype,r.name,S(n,r))}return e.toString=function(){return t.name+"#"+Number(t.code).toString(16)},e.prototype.toJSON=function(){var t={};for(var e in this)"value"!==e&&this[e]&&(t[e]=this[e]);return t},e.create=function(t){var n=new e;for(var r in t)n[r]=t[r];return n},e.prototype.described=function(){return f.described_nc(f.wrap_ulong(e.descriptor.numeric),f.wrap_list(this.value))},e},function(t){var e=f.define_composite(t);f["wrap_"+t.name]=function(t){return e.create(t).described()},b[Number(e.descriptor.numeric).toString(10)]=e,b[e.descriptor.symbolic]=e}({name:"error",code:29,fields:[{name:"condition",type:"symbol",mandatory:!0},{name:"description",type:"string"},{name:"info",type:"map"}]}),t.exports=f}).call(this,n(3).Buffer,n(4))},function(t,e,n){"use strict";var r=n(19);r.formatters.h=function(t){return t.toString("hex")},t.exports={frames:r("rhea:frames"),raw:r("rhea:raw"),reconnect:r("rhea:reconnect"),events:r("rhea:events"),message:r("rhea:message"),flow:r("rhea:flow"),io:r("rhea:io")}},function(t,e,n){var r=n(1).Buffer;function i(t,e){this._block=r.alloc(t),this._finalSize=e,this._blockSize=t,this._len=0}i.prototype.update=function(t,e){"string"==typeof t&&(e=e||"utf8",t=r.from(t,e));for(var n=this._block,i=this._blockSize,o=t.length,s=this._len,a=0;a<o;){for(var c=s%i,h=Math.min(o-a,i-c),u=0;u<h;u++)n[c+u]=t[a+u];a+=h,(s+=h)%i==0&&this._update(n)}return this._len+=o,this},i.prototype.digest=function(t){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var o=this._hash();return t?o.toString(t):o},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=i},function(t,e,n){"use strict";var r=n(13),i=n(12),o={},s={};function a(t,e){var n=r.define_composite(e);o[e.name]=n.create,s[Number(n.descriptor.numeric).toString(10)]=n,s[n.descriptor.symbolic]=n}o.read_header=function(t){var e=4,n={},r=t.toString("ascii",0,e);if("AMQP"!==r)throw new i.ProtocolError("Invalid protocol header for AMQP "+r);if(n.protocol_id=t.readUInt8(e++),n.major=t.readUInt8(e++),n.minor=t.readUInt8(e++),n.revision=t.readUInt8(e++),0===n.protocol_id&&0===n.major&&9===n.minor&&1===n.revision)throw new i.ProtocolError("Unsupported AMQP version: 0-9-1");if(1===n.protocol_id&&1===n.major&&0===n.minor&&10===n.revision)throw new i.ProtocolError("Unsupported AMQP version: 0-10");if(1!==n.major||0!==n.minor)throw new i.ProtocolError("Unsupported AMQP version: "+JSON.stringify(n));return n},o.write_header=function(t,e){var n=4;return t.write("AMQP",0,n,"ascii"),t.writeUInt8(e.protocol_id,n++),t.writeUInt8(e.major,n++),t.writeUInt8(e.minor,n++),t.writeUInt8(e.revision,n++),8},o.TYPE_AMQP=0,o.TYPE_SASL=1,o.read_frame=function(t){var e=new r.Reader(t),n={};if(n.size=e.read_uint(4),e.remaining<n.size)return null;var a=e.read_uint(1);if(a<2)throw new i.ProtocolError("Invalid data offset, must be at least 2 was "+a);if(n.type=e.read_uint(1),n.type===o.TYPE_AMQP)n.channel=e.read_uint(2);else{if(n.type!==o.TYPE_SASL)throw new i.ProtocolError("Unknown frame type "+n.type);e.skip(2)}if(a>1&&e.skip(4*a-8),e.remaining()){n.performative=e.read();var c=s[n.performative.descriptor.value];c&&(n.performative=new c(n.performative.value)),e.remaining()&&(n.payload=e.read_bytes(e.remaining()))}return n},o.write_frame=function(t){var e=new r.Writer;if(e.skip(4),e.write_uint(2,1),e.write_uint(t.type,1),t.type===o.TYPE_AMQP)e.write_uint(t.channel,2);else{if(t.type!==o.TYPE_SASL)throw new i.ProtocolError("Unknown frame type "+t.type);e.write_uint(0,2)}t.performative&&(e.write(t.performative),t.payload&&e.write_bytes(t.payload));var n=e.toBuffer();return n.writeUInt32BE(n.length,0),n},o.amqp_frame=function(t,e,n){return{channel:t||0,type:o.TYPE_AMQP,performative:e,payload:n}},o.sasl_frame=function(t){return{channel:0,type:o.TYPE_SASL,performative:t}};a(o.TYPE_AMQP,{name:"open",code:16,fields:[{name:"container_id",type:"string",mandatory:!0},{name:"hostname",type:"string"},{name:"max_frame_size",type:"uint",default_value:4294967295},{name:"channel_max",type:"ushort",default_value:65535},{name:"idle_time_out",type:"uint"},{name:"outgoing_locales",type:"symbol",multiple:!0},{name:"incoming_locales",type:"symbol",multiple:!0},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]}),a(o.TYPE_AMQP,{name:"begin",code:17,fields:[{name:"remote_channel",type:"ushort"},{name:"next_outgoing_id",type:"uint",mandatory:!0},{name:"incoming_window",type:"uint",mandatory:!0},{name:"outgoing_window",type:"uint",mandatory:!0},{name:"handle_max",type:"uint",default_value:"4294967295"},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]}),a(o.TYPE_AMQP,{name:"attach",code:18,fields:[{name:"name",type:"string",mandatory:!0},{name:"handle",type:"uint",mandatory:!0},{name:"role",type:"boolean",mandatory:!0},{name:"snd_settle_mode",type:"ubyte",default_value:2},{name:"rcv_settle_mode",type:"ubyte",default_value:0},{name:"source",type:"*"},{name:"target",type:"*"},{name:"unsettled",type:"map"},{name:"incomplete_unsettled",type:"boolean",default_value:!1},{name:"initial_delivery_count",type:"uint"},{name:"max_message_size",type:"ulong"},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]}),a(o.TYPE_AMQP,{name:"flow",code:19,fields:[{name:"next_incoming_id",type:"uint"},{name:"incoming_window",type:"uint",mandatory:!0},{name:"next_outgoing_id",type:"uint",mandatory:!0},{name:"outgoing_window",type:"uint",mandatory:!0},{name:"handle",type:"uint"},{name:"delivery_count",type:"uint"},{name:"link_credit",type:"uint"},{name:"available",type:"uint"},{name:"drain",type:"boolean",default_value:!1},{name:"echo",type:"boolean",default_value:!1},{name:"properties",type:"symbolic_map"}]}),a(o.TYPE_AMQP,{name:"transfer",code:20,fields:[{name:"handle",type:"uint",mandatory:!0},{name:"delivery_id",type:"uint"},{name:"delivery_tag",type:"binary"},{name:"message_format",type:"uint"},{name:"settled",type:"boolean"},{name:"more",type:"boolean",default_value:!1},{name:"rcv_settle_mode",type:"ubyte"},{name:"state",type:"delivery_state"},{name:"resume",type:"boolean",default_value:!1},{name:"aborted",type:"boolean",default_value:!1},{name:"batchable",type:"boolean",default_value:!1}]}),a(o.TYPE_AMQP,{name:"disposition",code:21,fields:[{name:"role",type:"boolean",mandatory:!0},{name:"first",type:"uint",mandatory:!0},{name:"last",type:"uint"},{name:"settled",type:"boolean",default_value:!1},{name:"state",type:"*"},{name:"batchable",type:"boolean",default_value:!1}]}),a(o.TYPE_AMQP,{name:"detach",code:22,fields:[{name:"handle",type:"uint",mandatory:!0},{name:"closed",type:"boolean",default_value:!1},{name:"error",type:"error"}]}),a(o.TYPE_AMQP,{name:"end",code:23,fields:[{name:"error",type:"error"}]}),a(o.TYPE_AMQP,{name:"close",code:24,fields:[{name:"error",type:"error"}]});a(o.TYPE_SASL,{name:"sasl_mechanisms",code:64,fields:[{name:"sasl_server_mechanisms",type:"symbol",multiple:!0,mandatory:!0}]}),a(o.TYPE_SASL,{name:"sasl_init",code:65,fields:[{name:"mechanism",type:"symbol",mandatory:!0},{name:"initial_response",type:"binary"},{name:"hostname",type:"string"}]}),a(o.TYPE_SASL,{name:"sasl_challenge",code:66,fields:[{name:"challenge",type:"binary",mandatory:!0}]}),a(o.TYPE_SASL,{name:"sasl_response",code:67,fields:[{name:"response",type:"binary",mandatory:!0}]}),a(o.TYPE_SASL,{name:"sasl_outcome",code:68,fields:[{name:"code",type:"ubyte",mandatory:!0},{name:"additional_data",type:"binary"}]}),t.exports=o},function(t,e,n){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return e.nextTick(function(){t.apply(null,o)})}}}:t.exports=e}).call(this,n(2))},function(t,e,n){(function(t){function n(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===n(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===n(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===n(t)},e.isError=function(t){return"[object Error]"===n(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(3).Buffer)},function(t,e,n){(function(r,i){function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==i&&"env"in i&&(t=i.env.DEBUG),t}(e=t.exports=n(58)).log=function(){return"object"==typeof r&&r.log&&Function.prototype.apply.call(r.log,r,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++i)}),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(4),n(2))},function(t,e){},function(t,e,n){"use strict";(function(e){var r=n(12),i={generate_uuid:function(){return i.uuid_to_string(i.uuid4())},uuid4:function(){for(var t=new e(16),n=0;n<t.length;n++)t[n]=255*Math.random()|0;return t[7]&=15,t[7]|=64,t[8]&=63,t[8]|=128,t},uuid_to_string:function(t){if(16===t.length)return[t.slice(0,4),t.slice(4,6),t.slice(6,8),t.slice(8,10),t.slice(10,16)].map(function(t){return t.toString("hex")}).join("-");throw new r.TypeError("Not a UUID, expecting 16 byte buffer")}},o=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/;i.string_to_uuid=function(t){var n=o.exec(t.toLowerCase());if(n)return e.from(n.slice(1).join(""),"hex");throw new r.TypeError("Not a valid UUID string: "+t)},i.clone=function(t){for(var e=Object.create(t.prototype||{}),n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var i=n[r];e[i]=t[i]}return e},i.and=function(t,e){return void 0===e?t:function(n){return t(n)&&e(n)}},i.is_sender=function(t){return t.is_sender()},i.is_receiver=function(t){return t.is_receiver()},i.sender_filter=function(t){return i.and(i.is_sender,t)},i.receiver_filter=function(t){return i.and(i.is_receiver,t)},i.is_defined=function(t){return void 0!==t&&null!==t},t.exports=i}).call(this,n(3).Buffer)},function(t,e,n){"use strict";var r=function(){this.init()};r.prototype.init=function(){this.local_open=!1,this.remote_open=!1,this.open_requests=0,this.close_requests=0,this.initialised=!1},r.prototype.open=function(){return this.initialised=!0,!this.local_open&&(this.local_open=!0,this.open_requests++,!0)},r.prototype.close=function(){return!!this.local_open&&(this.local_open=!1,this.close_requests++,!0)},r.prototype.disconnected=function(){var t=this.initialised;this.was_open=this.local_open,this.init(),this.initialised=t},r.prototype.reconnect=function(){this.was_open&&this.open()},r.prototype.remote_opened=function(){return!this.remote_open&&(this.remote_open=!0,!0)},r.prototype.remote_closed=function(){return!!this.remote_open&&(this.remote_open=!1,!0)},r.prototype.is_open=function(){return this.local_open&&this.remote_open},r.prototype.is_closed=function(){return this.initialised&&!this.local_open&&!this.remote_open},r.prototype.has_settled=function(){return 0===this.open_requests&&0===this.close_requests},r.prototype.need_open=function(){return this.open_requests>0&&(this.open_requests--,!0)},r.prototype.need_close=function(){return this.close_requests>0&&(this.close_requests--,!0)},t.exports=r},function(t,e,n){"use strict";(function(e){var r=n(14),i=n(13),o={},s={},a=[],c={};function h(t,e,n){e.descriptor=t,s[t.symbolic]=e,s[Number(t.numeric).toString(10)]=e,n&&a.push(n)}function u(t){var e=i.define_composite(t);c[t.name]=e.create,o[Number(e.descriptor.numeric).toString(10)]=e,o[e.descriptor.symbolic]=e;h(e.descriptor,function(n,r){for(var i=new e(r.value),o=0;o<t.fields.length;o++){var s=t.fields[o],a=i[s.name];void 0!==a&&null!==a&&(n[s.name]=a)}},function(t,n){t.push(e.create(n).described())})}function l(t,e){var n=e?i.wrap_symbolic_map:i.wrap_map,r={numeric:t.code};r.symbolic="amqp:"+t.name.replace(/_/g,"-")+":map";h(r,function(e,n){e[t.name]=i.unwrap_map_simple(n)},function(e,o){o[t.name]&&e.push(i.described_nc(i.wrap_ulong(r.numeric),n(o[t.name])))})}function f(t,e,n){this.typecode=t,this.content=e,this.multiple=n}function p(t,e,n){void 0===t.body?t.body=new f(n,i.unwrap(e)):t.body.constructor===f&&t.body.typecode===n&&(t.body.multiple?t.body.content.push(i.unwrap(e)):(t.body.multiple=!0,t.body.content=[t.body.content,i.unwrap(e)]))}function d(t){t&&function t(e,n){for(var r in e){var i=e[r];"object"==typeof i?t(i,n[r]):n[r]=i}}(t,this)}f.prototype.described=function(t){return i.described(i.wrap_ulong(this.typecode),i.wrap(t||this.content))},u({name:"header",code:112,fields:[{name:"durable",type:"boolean",default_value:!1},{name:"priority",type:"ubyte",default_value:4},{name:"ttl",type:"uint"},{name:"first_acquirer",type:"boolean",default_value:!1},{name:"delivery_count",type:"uint",default_value:0}]}),l({name:"delivery_annotations",code:113},!0),l({name:"message_annotations",code:114},!0),u({name:"properties",code:115,fields:[{name:"message_id",type:"message_id"},{name:"user_id",type:"binary"},{name:"to",type:"string"},{name:"subject",type:"string"},{name:"reply_to",type:"string"},{name:"correlation_id",type:"message_id"},{name:"content_type",type:"symbol"},{name:"content_encoding",type:"symbol"},{name:"absolute_expiry_time",type:"timestamp"},{name:"creation_time",type:"timestamp"},{name:"group_id",type:"string"},{name:"group_sequence",type:"uint"},{name:"reply_to_group_id",type:"string"}]}),l({name:"application_properties",code:116}),h({numeric:117,symbolic:"amqp:data:binary"},function(t,e){p(t,e,117)}),h({numeric:118,symbolic:"amqp:amqp-sequence:list"},function(t,e){p(t,e,118)}),h({numeric:119,symbolic:"amqp:value:*"},function(t,e){t.body=i.unwrap(e)}),l({name:"footer",code:120}),a.push(function(t,e){e.body&&e.body.constructor===f?e.body.multiple?e.body.content.forEach(function(n){t.push(e.body.described(n))}):t.push(e.body.described()):t.push(i.described(i.wrap_ulong(119),i.wrap(e.body)))}),c.data_section=function(t){return new f(117,t)},c.sequence_section=function(t){return new f(118,t)},c.data_sections=function(t){return new f(117,t,!0)},c.sequence_sections=function(t){return new f(118,t,!0)},d.prototype.toJSON=function(){var t={};for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t},d.prototype.inspect=function(){return JSON.stringify(this.toJSON())},d.prototype.toString=function(){return JSON.stringify(this.toJSON())},c.encode=function(t){var e=[];a.forEach(function(n){n(e,t)});for(var n=new i.Writer,o=0;o<e.length;o++)r.message("Encoding section %d of %d: %o",o+1,e.length,e[o]),n.write(e[o]);var s=n.toBuffer();return r.message("encoded %d bytes",s.length),s},c.decode=function(t){for(var n=new d,o=new i.Reader(t);o.remaining();){var a=o.read();if(r.message("decoding section: %o of type: %o",a,a.descriptor),a.descriptor){var c=s[a.descriptor.value];c?c(n,a):e.warn("WARNING: did not recognise message section with descriptor "+a.descriptor)}else e.warn("WARNING: expected described message section got "+JSON.stringify(a))}return n};var _={};function m(t){var e=i.define_composite(t);e.composite_type=t.name,c[t.name]=e.create,_[Number(e.descriptor.numeric).toString(10)]=e,_[e.descriptor.symbolic]=e,c["is_"+t.name]=function(e){if(e&&e.descriptor){var n=_[e.descriptor.value];if(n)return n.descriptor.numeric===t.code}return!1}}c.unwrap_outcome=function(t){if(t&&t.descriptor){var n=_[t.descriptor.value];if(n)return new n(t.value)}return e.error("unrecognised outcome: "+JSON.stringify(t)),t},c.are_outcomes_equivalent=function(t,e){return void 0===t&&void 0===e||void 0!==t&&void 0!==e&&(t.descriptor.value===e.descriptor.value&&36===t.descriptor.value)},m({name:"received",code:35,fields:[{name:"section_number",type:"uint",mandatory:!0},{name:"section_offset",type:"ulong",mandatory:!0}]}),m({name:"accepted",code:36,fields:[]}),m({name:"rejected",code:37,fields:[{name:"error",type:"error"}]}),m({name:"released",code:38,fields:[]}),m({name:"modified",code:39,fields:[{name:"delivery_failed",type:"boolean"},{name:"undeliverable_here",type:"boolean"},{name:"message_annotations",type:"map"}]}),t.exports=c}).call(this,n(4))},function(t,e,n){"use strict";var r=n(64),i=n(66);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=v,e.resolve=function(t,e){return v(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e},e.format=function(t){i.isString(t)&&(t=v(t));return t instanceof o?t.format():o.prototype.format.call(t)},e.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(h),l=["%","/","?",";","#"].concat(u),f=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=n(67);function v(t,e,n){if(t&&i.isObject(t)&&t instanceof o)return t;var r=new o;return r.parse(t,e,n),r}o.prototype.parse=function(t,e,n){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",h=t.split(a);h[0]=h[0].replace(/\\/g,"/");var v=t=h.join(a);if(v=v.trim(),!n&&1===t.split("#").length){var b=c.exec(v);if(b)return this.path=v,this.href=v,this.pathname=b[1],b[2]?(this.search=b[2],this.query=e?g.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var w=s.exec(v);if(w){var E=(w=w[0]).toLowerCase();this.protocol=E,v=v.substr(w.length)}if(n||w||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===v.substr(0,2);!S||w&&m[w]||(v=v.substr(2),this.slashes=!0)}if(!m[w]&&(S||w&&!y[w])){for(var k,x,I=-1,A=0;A<f.length;A++){-1!==(T=v.indexOf(f[A]))&&(-1===I||T<I)&&(I=T)}-1!==(x=-1===I?v.lastIndexOf("@"):v.lastIndexOf("@",I))&&(k=v.slice(0,x),v=v.slice(x+1),this.auth=decodeURIComponent(k)),I=-1;for(A=0;A<l.length;A++){var T;-1!==(T=v.indexOf(l[A]))&&(-1===I||T<I)&&(I=T)}-1===I&&(I=v.length),this.host=v.slice(0,I),v=v.slice(I),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var O=this.hostname.split(/\./),U=(A=0,O.length);A<U;A++){var P=O[A];if(P&&!P.match(p)){for(var R="",M=0,B=P.length;M<B;M++)P.charCodeAt(M)>127?R+="x":R+=P[M];if(!R.match(p)){var j=O.slice(0,A),L=O.slice(A+1),N=P.match(d);N&&(j.push(N[1]),L.unshift(N[2])),L.length&&(v="/"+L.join(".")+v),this.hostname=j.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=r.toASCII(this.hostname));var q=this.port?":"+this.port:"",D=this.hostname||"";this.host=D+q,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!_[E])for(A=0,U=u.length;A<U;A++){var F=u[A];if(-1!==v.indexOf(F)){var z=encodeURIComponent(F);z===F&&(z=escape(F)),v=v.split(F).join(z)}}var W=v.indexOf("#");-1!==W&&(this.hash=v.substr(W),v=v.slice(0,W));var Y=v.indexOf("?");if(-1!==Y?(this.search=v.substr(Y),this.query=v.substr(Y+1),e&&(this.query=g.parse(this.query)),v=v.slice(0,Y)):e&&(this.search="",this.query={}),v&&(this.pathname=v),y[E]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){q=this.pathname||"";var H=this.search||"";this.path=q+H}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=g.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||y[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),e+o+(n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(a=a.replace("#","%23"))+r},o.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(i.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var n=new o,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var c=Object.keys(t),h=0;h<c.length;h++){var u=c[h];"protocol"!==u&&(n[u]=t[u])}return y[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!y[t.protocol]){for(var l=Object.keys(t),f=0;f<l.length;f++){var p=l[f];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||m[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var _=n.pathname||"",g=n.search||"";n.path=_+g}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var v=n.pathname&&"/"===n.pathname.charAt(0),b=t.host||t.pathname&&"/"===t.pathname.charAt(0),w=b||v||n.host&&t.pathname,E=w,S=n.pathname&&n.pathname.split("/")||[],k=(d=t.pathname&&t.pathname.split("/")||[],n.protocol&&!y[n.protocol]);if(k&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),w=w&&(""===d[0]||""===S[0])),b)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,S=d;else if(d.length)S||(S=[]),S.pop(),S=S.concat(d),n.search=t.search,n.query=t.query;else if(!i.isNullOrUndefined(t.search)){if(k)n.hostname=n.host=S.shift(),(C=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=C.shift(),n.host=n.hostname=C.shift());return n.search=t.search,n.query=t.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var x=S.slice(-1)[0],I=(n.host||t.host||S.length>1)&&("."===x||".."===x)||""===x,A=0,T=S.length;T>=0;T--)"."===(x=S[T])?S.splice(T,1):".."===x?(S.splice(T,1),A++):A&&(S.splice(T,1),A--);if(!w&&!E)for(;A--;A)S.unshift("..");!w||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),I&&"/"!==S.join("/").substr(-1)&&S.push("");var C,O=""===S[0]||S[0]&&"/"===S[0].charAt(0);k&&(n.hostname=n.host=O?"":S.length?S.shift():"",(C=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=C.shift(),n.host=n.hostname=C.shift()));return(w=w||n.host&&S.length)&&!O&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){"use strict";(function(e,r,i){var o=n(17);function s(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;t.entry=null;for(;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=g;var a,c=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?r:o.nextTick;g.WritableState=y;var h=n(18);h.inherits=n(0);var u={deprecate:n(79)},l=n(35),f=n(1).Buffer,p=i.Uint8Array||function(){};var d,_=n(36);function m(){}function y(t,e){a=a||n(10),t=t||{};var r=e instanceof a;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,h=t.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(h||0===h)?h:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var l=!1===t.decodeStrings;this.decodeStrings=!l,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?(o.nextTick(i,r),o.nextTick(k,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(i(r),t._writableState.errorEmitted=!0,t.emit("error",r),k(t,e))}(t,n,r,e,i);else{var s=E(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||w(t,n),r?c(b,t,n,s,i):b(t,n,s,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function g(t){if(a=a||n(10),!(d.call(g,this)||this instanceof a))return new g(t);this._writableState=new y(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),l.call(this)}function v(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function b(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),k(t,e)}function w(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),o=e.corkedRequestsFree;o.entry=n;for(var a=0,c=!0;n;)i[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;i.allBuffers=c,v(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new s(e),e.bufferedRequestCount=0}else{for(;n;){var h=n.chunk,u=n.encoding,l=n.callback;if(v(t,e,!1,e.objectMode?1:h.length,h,u,l),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function E(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function S(t,e){t._final(function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),k(t,e)})}function k(t,e){var n=E(e);return n&&(!function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,o.nextTick(S,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}h.inherits(g,l),y.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(y.prototype,"buffer",{get:u.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(t){return!!d.call(this,t)||this===g&&(t&&t._writableState instanceof y)}})):d=function(t){return t instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(t,e,n){var r=this._writableState,i=!1,s=!r.objectMode&&function(t){return f.isBuffer(t)||t instanceof p}(t);return s&&!f.isBuffer(t)&&(t=function(t){return f.from(t)}(t)),"function"==typeof e&&(n=e,e=null),s?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof n&&(n=m),r.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),o.nextTick(e,n)}(this,n):(s||function(t,e,n,r){var i=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),o.nextTick(r,s),i=!1),i}(this,r,t,n))&&(r.pendingcb++,i=function(t,e,n,r,i,o){if(!n){var s=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=f.from(e,n));return e}(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;c||(e.needDrain=!0);if(e.writing||e.corked){var h=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},h?h.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else v(t,e,!1,a,r,i,o);return c}(this,r,s,t,e,n)),i},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||w(this,t))},g.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,k(t,e),n&&(e.finished?o.nextTick(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),g.prototype.destroy=_.destroy,g.prototype._undestroy=_.undestroy,g.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(2),n(77).setImmediate,n(5))},function(t,e,n){"use strict";var r=n(1).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=c,this.end=h,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=u,this.end=l,e=3;break;default:return this.write=f,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function c(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function h(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function u(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function l(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}e.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);if(i>=0)return i>0&&(t.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=s(e[r]))>=0)return i>0&&(t.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=s(e[r]))>=0)return i>0&&(2===i?i=0:t.lastNeed=i-3),i;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e){t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var r=arguments[e];for(var i in r)n.call(r,i)&&(t[i]=r[i])}return t};var n=Object.prototype.hasOwnProperty},function(t,e,n){"use strict";var r=n(104);t.exports=function(t,e){var n;function i(r){e.rejectUnauthorized&&t.emit("error",r),n.end()}return e.port=e.port||8883,e.host=e.hostname||e.host||"localhost",e.rejectUnauthorized=!1!==e.rejectUnauthorized,delete e.path,(n=r.connect(e)).on("secureConnect",function(){e.rejectUnauthorized&&!n.authorized?n.emit("error",new Error("TLS not authorized")):n.removeListener("error",i)}),n.on("error",i),n}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";(function(e){var r=n(12),i=n(16),o=n(31),s=0,a=1;var c=function(t){this.callback=t,this.outcome=void 0,this.username=void 0};c.prototype.start=function(t,e){var n=function(t){for(var e=[],n=0,r=0;r<t.length;)0===t[r]?(r>n?e.push(t.toString("utf8",n,r)):e.push(null),n=++r):++r;return r>n?e.push(t.toString("utf8",n,r)):e.push(null),e}(t);3!==n.length&&this.connection.sasl_failed("Unexpected response in PLAIN, got "+n.length+" fields, expected 3"),this.callback(n[1],n[2],e)?(this.outcome=!0,this.username=n[1]):this.outcome=!1};var h=function(t,e){this.username=t,this.password=e};h.prototype.start=function(){var t=new e(1+this.username.length+1+this.password.length);return t.writeUInt8(0,0),t.write(this.username,1),t.writeUInt8(0,1+this.username.length),t.write(this.password,1+this.username.length+1),t};var u=function(){this.outcome=void 0,this.username=void 0};u.prototype.start=function(t){this.outcome=!0,this.username=t?t.toString("utf8"):"anonymous"};var l=function(t){this.username=t||"anonymous"};l.prototype.start=function(){var t=new e(1+this.username.length);return t.writeUInt8(0,0),t.write(this.username,1),t};var f=function(){this.outcome=void 0,this.username=void 0};f.prototype.start=function(){this.outcome=!0};var p=function(){this.username=void 0};p.prototype.start=function(){return""},p.prototype.step=function(){return""};var d=function(t,e){this.username=t,this.token=e};d.prototype.start=function(){var t=new e(this.username.length+this.token.length+5+12+3),n=0;return t.write("user=",n),n+=5,t.write(this.username,n),n+=this.username.length,t.writeUInt8(1,n),n+=1,t.write("auth=Bearer ",n),n+=12,t.write(this.token,n),n+=this.token.length,t.writeUInt8(1,n),n+=1,t.writeUInt8(1,n),n+=1,t};var _=function(t,e){this.connection=t,this.transport=new o(t.amqp_transport.identifier,3,i.TYPE_SASL,this),this.next=t.amqp_transport,this.mechanisms=e,this.mechanism=void 0,this.outcome=void 0,this.username=void 0;var n=Object.getOwnPropertyNames(e);this.transport.encode(i.sasl_frame(i.sasl_mechanisms({sasl_server_mechanisms:n}).described()))};_.prototype.do_step=function(t){void 0===this.mechanism.outcome?this.transport.encode(i.sasl_frame(i.sasl_challenge({challenge:t}).described())):(this.outcome=this.mechanism.outcome?s:a,this.transport.encode(i.sasl_frame(i.sasl_outcome({code:this.outcome}).described())),this.outcome===s&&(this.username=this.mechanism.username,this.transport.write_complete=!0,this.transport.read_complete=!0))},_.prototype.on_sasl_init=function(t){var e=this.mechanisms[t.performative.mechanism];if(e){this.mechanism=e();var n=this.mechanism.start(t.performative.initial_response,t.performative.hostname);this.do_step(n)}else this.outcome=a,this.transport.encode(i.sasl_frame(i.sasl_outcome({code:this.outcome}).described()))},_.prototype.on_sasl_response=function(t){this.do_step(this.mechanism.step(t.performative.response))},_.prototype.has_writes_pending=function(){return this.transport.has_writes_pending()||this.next.has_writes_pending()},_.prototype.write=function(t){return this.transport.write_complete&&0===this.transport.pending.length?this.next.write(t):this.transport.write(t)},_.prototype.read=function(t){return this.transport.read_complete?this.next.read(t):this.transport.read(t)};var m=function(t,e,n){this.connection=t,this.transport=new o(t.amqp_transport.identifier,3,i.TYPE_SASL,this),this.next=t.amqp_transport,this.mechanisms=e,this.mechanism=void 0,this.mechanism_name=void 0,this.hostname=n,this.failed=!1};m.prototype.on_sasl_mechanisms=function(t){for(var e=0;void 0===this.mechanism&&e<t.performative.sasl_server_mechanisms.length;e++){var n=t.performative.sasl_server_mechanisms[e],r=this.mechanisms[n];r&&(this.mechanism=r(),this.mechanism_name=n)}if(this.mechanism){var o=this.mechanism.start(),s={mechanism:this.mechanism_name,initial_response:o};this.hostname&&(s.hostname=this.hostname),this.transport.encode(i.sasl_frame(i.sasl_init(s).described()))}else this.failed=!0,this.connection.sasl_failed("No suitable mechanism; server supports "+t.performative.sasl_server_mechanisms)},m.prototype.on_sasl_challenge=function(t){var e=this.mechanism.step(t.performative.challenge);this.transport.encode(i.sasl_frame(i.sasl_response({response:e}).described()))},m.prototype.on_sasl_outcome=function(t){switch(t.performative.code){case s:this.transport.read_complete=!0,this.transport.write_complete=!0;break;default:this.transport.write_complete=!0,this.connection.sasl_failed("Failed to authenticate: "+t.performative.code)}},m.prototype.has_writes_pending=function(){return this.transport.has_writes_pending()||this.next.has_writes_pending()},m.prototype.write=function(t){return this.transport.write_complete?this.next.write(t):this.transport.write(t)},m.prototype.read=function(t){return this.transport.read_complete?this.next.read(t):this.transport.read(t)};var y=function(t,e){this.header_received=!1,this.transports={0:t.amqp_transport,3:new _(t,e)},this.selected=void 0};y.prototype.has_writes_pending=function(){return this.header_received&&this.selected.has_writes_pending()},y.prototype.write=function(t){return this.selected?this.selected.write(t):0},y.prototype.read=function(t){if(!this.header_received){if(t.length<8)return 0;if(this.header_received=i.read_header(t),this.selected=this.transports[this.header_received.protocol_id],void 0===this.selected)throw new r.ProtocolError("Invalid AMQP protocol id "+this.header_received.protocol_id)}return this.selected.read(t)};var g={enable_anonymous:function(){this.ANONYMOUS=function(){return new u}},enable_plain:function(t){this.PLAIN=function(){return new c(t)}}},v={enable_anonymous:function(t){this.ANONYMOUS=function(){return new l(t)}},enable_plain:function(t,e){this.PLAIN=function(){return new h(t,e)}},enable_external:function(){this.EXTERNAL=function(){return new p}},enable_xoauth2:function(t,e){if(t&&e)this.XOAUTH2=function(){return new d(t,e)};else{if(void 0===e)throw Error("token must be specified");if(void 0===t)throw Error("username must be specified")}}};t.exports={Client:m,Server:_,Selective:y,server_mechanisms:function(){return Object.create(g)},client_mechanisms:function(){return Object.create(v)},server_add_external:function(t){return t.EXTERNAL=function(){return new f},t}}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){var r=n(12),i=n(16),o=n(14),s=function(t,e,n,r){this.identifier=t,this.protocol_id=e,this.frame_type=n,this.handler=r,this.pending=[],this.header_sent=void 0,this.header_received=void 0,this.write_complete=!1,this.read_complete=!1};s.prototype.has_writes_pending=function(){return this.pending.length>0},s.prototype.encode=function(t){this.pending.push(t)},s.prototype.write=function(t){if(!this.header_sent){var n=new e(8),r={protocol_id:this.protocol_id,major:1,minor:0,revision:0};o.frames("[%s] -> %o",this.identifier,r),i.write_header(n,r),t.write(n),this.header_sent=r}for(var s=0;s<this.pending.length;s++){var a=this.pending[s];n=i.write_frame(a);t.write(n),a.performative?o.frames("[%s]:%s -> %s %j",this.identifier,a.channel,a.performative.constructor,a.performative,a.payload||""):o.frames("[%s]:%s -> empty",this.identifier,a.channel),o.raw("[%s] SENT: %d %h",this.identifier,n.length,n)}this.pending=[]},s.prototype.read=function(t){var e=0;if(!this.header_received){if(t.length<8)return e;if(this.header_received=i.read_header(t),o.frames("[%s] <- %o",this.identifier,this.header_received),this.header_received.protocol_id!==this.protocol_id)throw 3===this.protocol_id&&0===this.header_received.protocol_id?new r.ProtocolError("Expecting SASL layer"):0===this.protocol_id&&3===this.header_received.protocol_id?new r.ProtocolError("SASL layer not enabled"):new r.ProtocolError("Invalid AMQP protocol id "+this.header_received.protocol_id+" expecting: "+this.protocol_id);e=8}for(;e<t.length-4&&!this.read_complete;){var n=t.readUInt32BE(e);if(o.io("[%s] got frame of size %d",this.identifier,n),t.length<e+n){o.io("[%s] incomplete frame; have only %d of %d",this.identifier,t.length-e,n);break}var s=t.slice(e,e+n);o.raw("[%s] RECV: %d %h",this.identifier,s.length,s);var a=i.read_frame(s);if(a.performative?o.frames("[%s]:%s <- %s %j",this.identifier,a.channel,a.performative.constructor,a.performative,a.payload||""):o.frames("[%s]:%s <- empty",this.identifier,a.channel),a.type!==this.frame_type)throw new r.ProtocolError("Invalid frame type: "+a.type);e+=n,a.performative&&a.performative.dispatch(this.handler,a)}return e},t.exports=s}).call(this,n(3).Buffer)},function(t,e,n){var r=n(1).Buffer,i=n(33).Transform,o=n(26).StringDecoder;function s(t){i.call(this),this.hashMode="string"==typeof t,this.hashMode?this[t]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}n(0)(s,i),s.prototype.update=function(t,e,n){"string"==typeof t&&(t=r.from(t,e));var i=this._update(t);return this.hashMode?this:(n&&(i=this._toString(i,n)),i)},s.prototype.setAutoPadding=function(){},s.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},s.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},s.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},s.prototype._transform=function(t,e,n){var r;try{this.hashMode?this._update(t):this.push(this._update(t))}catch(t){r=t}finally{n(r)}},s.prototype._flush=function(t){var e;try{this.push(this.__final())}catch(t){e=t}t(e)},s.prototype._finalOrDigest=function(t){var e=this.__final()||r.alloc(0);return t&&(e=this._toString(e,t,!0)),e},s.prototype._toString=function(t,e,n){if(this._decoder||(this._decoder=new o(e),this._encoding=e),this._encoding!==e)throw new Error("can't switch encodings");var r=this._decoder.write(t);return n&&(r+=this._decoder.end()),r},t.exports=s},function(t,e,n){t.exports=i;var r=n(6).EventEmitter;function i(){r.call(this)}n(0)(i,r),i.Readable=n(9),i.Writable=n(81),i.Duplex=n(38),i.Transform=n(82),i.PassThrough=n(83),i.Stream=i,i.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",a),n.on("close",c));var s=!1;function a(){s||(s=!0,t.end())}function c(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function h(t){if(u(),0===r.listenerCount(this,"error"))throw t}function u(){n.removeListener("data",i),t.removeListener("drain",o),n.removeListener("end",a),n.removeListener("close",c),n.removeListener("error",h),t.removeListener("error",h),n.removeListener("end",u),n.removeListener("close",u),t.removeListener("close",u)}return n.on("error",h),t.on("error",h),n.on("end",u),n.on("close",u),t.on("close",u),t.emit("pipe",n),t}},function(t,e,n){"use strict";(function(e,r){var i=n(17);t.exports=v;var o,s=n(29);v.ReadableState=g;n(6).EventEmitter;var a=function(t,e){return t.listeners(e).length},c=n(35),h=n(1).Buffer,u=e.Uint8Array||function(){};var l=n(18);l.inherits=n(0);var f=n(74),p=void 0;p=f&&f.debuglog?f.debuglog("stream"):function(){};var d,_=n(75),m=n(36);l.inherits(v,c);var y=["error","close","destroy","pause","resume"];function g(t,e){o=o||n(10),t=t||{};var r=e instanceof o;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,s=t.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new _,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=n(26).StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function v(t){if(o=o||n(10),!(this instanceof v))return new v(t);this._readableState=new g(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),c.call(this)}function b(t,e,n,r,i){var o,s=t._readableState;null===e?(s.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,k(t)}(t,s)):(i||(o=function(t,e){var n;(function(t){return h.isBuffer(t)||t instanceof u})(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(s,e)),o?t.emit("error",o):s.objectMode||e&&e.length>0?("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===h.prototype||(e=function(t){return h.from(t)}(e)),r?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):w(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(e=s.decoder.write(e),s.objectMode||0!==e.length?w(t,s,e,!1):I(t,s)):w(t,s,e,!1))):r||(s.reading=!1));return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(s)}function w(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&k(t)),I(t,e)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),v.prototype.destroy=m.destroy,v.prototype._undestroy=m.undestroy,v.prototype._destroy=function(t,e){this.push(null),e(t)},v.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=h.from(t,e),e=""),n=!0),b(this,t,e,!1,n)},v.prototype.unshift=function(t){return b(this,t,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(t){return d||(d=n(26).StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=t,this};var E=8388608;function S(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=E?t=E:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function k(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(p("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(x,t):x(t))}function x(t){p("emit readable"),t.emit("readable"),O(t)}function I(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(A,t,e))}function A(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(p("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function T(t){p("readable nexttick read 0"),t.read(0)}function C(t,e){e.reading||(p("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),O(t),e.flowing&&!e.reading&&t.read(0)}function O(t){var e=t._readableState;for(p("flow",e.flowing);e.flowing&&null!==t.read(););}function U(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;t-=i.length;for(;n=n.next;){var o=n.data,s=t>o.length?o.length:t;if(s===o.length?i+=o:i+=o.slice(0,t),0===(t-=s)){s===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(s));break}++r}return e.length-=r,i}(t,e):function(t,e){var n=h.allocUnsafe(t),r=e.head,i=1;r.data.copy(n),t-=r.data.length;for(;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,s),0===(t-=s)){s===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++i}return e.length-=i,n}(t,e);return r}(t,e.buffer,e.decoder),n);var n}function P(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick(R,e,t))}function R(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function M(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}v.prototype.read=function(t){p("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return p("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?P(this):k(this),null;if(0===(t=S(t,e))&&e.ended)return 0===e.length&&P(this),null;var r,i=e.needReadable;return p("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&p("length less than watermark",i=!0),e.ended||e.reading?p("reading or ended",i=!1):i&&(p("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=S(n,e))),null===(r=t>0?U(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&P(this)),null!==r&&this.emit("data",r),r},v.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(t,e){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,e);var c=(!e||!1!==e.end)&&t!==r.stdout&&t!==r.stderr?u:v;function h(e,r){p("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,p("cleanup"),t.removeListener("close",y),t.removeListener("finish",g),t.removeListener("drain",l),t.removeListener("error",m),t.removeListener("unpipe",h),n.removeListener("end",u),n.removeListener("end",v),n.removeListener("data",_),f=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||l())}function u(){p("onend"),t.end()}o.endEmitted?i.nextTick(c):n.once("end",c),t.on("unpipe",h);var l=function(t){return function(){var e=t._readableState;p("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&a(t,"data")&&(e.flowing=!0,O(t))}}(n);t.on("drain",l);var f=!1;var d=!1;function _(e){p("ondata"),d=!1,!1!==t.write(e)||d||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==M(o.pipes,t))&&!f&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function m(e){p("onerror",e),v(),t.removeListener("error",m),0===a(t,"error")&&t.emit("error",e)}function y(){t.removeListener("finish",g),v()}function g(){p("onfinish"),t.removeListener("close",y),v()}function v(){p("unpipe"),n.unpipe(t)}return n.on("data",_),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?s(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",m),t.once("close",y),t.once("finish",g),t.emit("pipe",n),o.flowing||(p("pipe resume"),n.resume()),t},v.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n),this);if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var s=M(e.pipes,t);return-1===s?this:(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n),this)},v.prototype.on=function(t,e){var n=c.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&k(this):i.nextTick(T,this))}return n},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var t=this._readableState;return t.flowing||(p("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(C,t,e))}(this,t)),this},v.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",function(){if(p("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(i){(p("wrapped data"),n.decoder&&(i=n.decoder.write(i)),!n.objectMode||null!==i&&void 0!==i)&&((n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause())))}),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<y.length;o++)t.on(y[o],this.emit.bind(this,y[o]));return this._read=function(e){p("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=U}).call(this,n(5),n(2))},function(t,e,n){t.exports=n(6).EventEmitter},function(t,e,n){"use strict";var r=n(17);function i(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(r.nextTick(i,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";t.exports=o;var r=n(10),i=n(18);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t),this._transformState={afterTransform:function(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"==typeof this._flush?this._flush(function(e,n){a(t,e,n)}):a(this,null,null)}function a(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=n(0),i.inherits(o,r),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,function(t){e(t),n.emit("close")})}},function(t,e,n){t.exports=n(10)},function(t,e,n){"use strict";var r=n(1).Buffer,i=n(33).Transform;function o(t){i.call(this),this._block=r.allocUnsafe(t),this._blockSize=t,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}n(0)(o,i),o.prototype._transform=function(t,e,n){var r=null;try{this.update(t,e)}catch(t){r=t}n(r)},o.prototype._flush=function(t){var e=null;try{this.push(this.digest())}catch(t){e=t}t(e)},o.prototype.update=function(t,e){if(function(t,e){if(!r.isBuffer(t)&&"string"!=typeof t)throw new TypeError(e+" must be a string or a buffer")}(t,"Data"),this._finalized)throw new Error("Digest already called");r.isBuffer(t)||(t=r.from(t,e));for(var n=this._block,i=0;this._blockOffset+t.length-i>=this._blockSize;){for(var o=this._blockOffset;o<this._blockSize;)n[o++]=t[i++];this._update(),this._blockOffset=0}for(;i<t.length;)n[this._blockOffset++]=t[i++];for(var s=0,a=8*t.length;a>0;++s)this._length[s]+=a,(a=this._length[s]/4294967296|0)>0&&(this._length[s]-=4294967296*a);return this},o.prototype._update=function(){throw new Error("_update is not implemented")},o.prototype.digest=function(t){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var e=this._digest();void 0!==t&&(e=e.toString(t)),this._block.fill(0),this._blockOffset=0;for(var n=0;n<4;++n)this._length[n]=0;return e},o.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=o},function(t,e,n){var r=n(0),i=n(15),o=n(1).Buffer,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function c(){this.init(),this._w=a,i.call(this,64,56)}function h(t,e,n){return n^t&(e^n)}function u(t,e,n){return t&e|n&(t|e)}function l(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function f(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function p(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}function d(t){return(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10}r(c,i),c.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},c.prototype._update=function(t){for(var e=this._w,n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,a=0|this._e,c=0|this._f,_=0|this._g,m=0|this._h,y=0;y<16;++y)e[y]=t.readInt32BE(4*y);for(;y<64;++y)e[y]=d(e[y-2])+e[y-7]+p(e[y-15])+e[y-16]|0;for(var g=0;g<64;++g){var v=m+f(a)+h(a,c,_)+s[g]+e[g]|0,b=l(n)+u(n,r,i)|0;m=_,_=c,c=a,a=o+v|0,o=i,i=r,r=n,n=v+b|0}this._a=n+this._a|0,this._b=r+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=a+this._e|0,this._f=c+this._f|0,this._g=_+this._g|0,this._h=m+this._h|0},c.prototype._hash=function(){var t=o.allocUnsafe(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},t.exports=c},function(t,e,n){var r=n(0),i=n(15),o=n(1).Buffer,s=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function c(){this.init(),this._w=a,i.call(this,128,112)}function h(t,e,n){return n^t&(e^n)}function u(t,e,n){return t&e|n&(t|e)}function l(t,e){return(t>>>28|e<<4)^(e>>>2|t<<30)^(e>>>7|t<<25)}function f(t,e){return(t>>>14|e<<18)^(t>>>18|e<<14)^(e>>>9|t<<23)}function p(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^t>>>7}function d(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)}function _(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^t>>>6}function m(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^(t>>>6|e<<26)}function y(t,e){return t>>>0<e>>>0?1:0}r(c,i),c.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},c.prototype._update=function(t){for(var e=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,o=0|this._dh,a=0|this._eh,c=0|this._fh,g=0|this._gh,v=0|this._hh,b=0|this._al,w=0|this._bl,E=0|this._cl,S=0|this._dl,k=0|this._el,x=0|this._fl,I=0|this._gl,A=0|this._hl,T=0;T<32;T+=2)e[T]=t.readInt32BE(4*T),e[T+1]=t.readInt32BE(4*T+4);for(;T<160;T+=2){var C=e[T-30],O=e[T-30+1],U=p(C,O),P=d(O,C),R=_(C=e[T-4],O=e[T-4+1]),M=m(O,C),B=e[T-14],j=e[T-14+1],L=e[T-32],N=e[T-32+1],q=P+j|0,D=U+B+y(q,P)|0;D=(D=D+R+y(q=q+M|0,M)|0)+L+y(q=q+N|0,N)|0,e[T]=D,e[T+1]=q}for(var F=0;F<160;F+=2){D=e[F],q=e[F+1];var z=u(n,r,i),W=u(b,w,E),Y=l(n,b),H=l(b,n),K=f(a,k),Q=f(k,a),$=s[F],J=s[F+1],V=h(a,c,g),G=h(k,x,I),Z=A+Q|0,X=v+K+y(Z,A)|0;X=(X=(X=X+V+y(Z=Z+G|0,G)|0)+$+y(Z=Z+J|0,J)|0)+D+y(Z=Z+q|0,q)|0;var tt=H+W|0,et=Y+z+y(tt,H)|0;v=g,A=I,g=c,I=x,c=a,x=k,a=o+X+y(k=S+Z|0,S)|0,o=i,S=E,i=r,E=w,r=n,w=b,n=X+et+y(b=Z+tt|0,Z)|0}this._al=this._al+b|0,this._bl=this._bl+w|0,this._cl=this._cl+E|0,this._dl=this._dl+S|0,this._el=this._el+k|0,this._fl=this._fl+x|0,this._gl=this._gl+I|0,this._hl=this._hl+A|0,this._ah=this._ah+n+y(this._al,b)|0,this._bh=this._bh+r+y(this._bl,w)|0,this._ch=this._ch+i+y(this._cl,E)|0,this._dh=this._dh+o+y(this._dl,S)|0,this._eh=this._eh+a+y(this._el,k)|0,this._fh=this._fh+c+y(this._fl,x)|0,this._gh=this._gh+g+y(this._gl,I)|0,this._hh=this._hh+v+y(this._hl,A)|0},c.prototype._hash=function(){var t=o.allocUnsafe(64);function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t},t.exports=c},function(t,e,n){"use strict";(function(e){var r=n(27),i=n(9).Readable,o={objectMode:!0},s={clean:!0};function a(t){if(!(this instanceof a))return new a(t);this.options=t||{},this.options=r(s,t),this._inflights={}}a.prototype.put=function(t,e){return this._inflights[t.messageId]=t,e&&e(),this},a.prototype.createStream=function(){var t=new i(o),n=this._inflights,r=Object.keys(this._inflights),s=!1,a=0;return t._read=function(){!s&&a<r.length?this.push(n[r[a++]]):this.push(null)},t.destroy=function(){if(!s){var t=this;s=!0,e.nextTick(function(){t.emit("close")})}},t},a.prototype.del=function(t,e){return(t=this._inflights[t.messageId])?(delete this._inflights[t.messageId],e(null,t)):e&&e(new Error("missing packet")),this},a.prototype.get=function(t,e){return(t=this._inflights[t.messageId])?e(null,t):e&&e(new Error("missing packet")),this},a.prototype.close=function(t){this.options.clean&&(this._inflights=null),t&&t()},t.exports=a}).call(this,n(2))},function(t,e,n){var r=n(93),i=function(){},o=function(t,e,n){if("function"==typeof e)return o(t,null,e);e||(e={}),n=r(n||i);var s=t._writableState,a=t._readableState,c=e.readable||!1!==e.readable&&t.readable,h=e.writable||!1!==e.writable&&t.writable,u=function(){t.writable||l()},l=function(){h=!1,c||n.call(t)},f=function(){c=!1,h||n.call(t)},p=function(e){n.call(t,e?new Error("exited with error code: "+e):null)},d=function(e){n.call(t,e)},_=function(){return(!c||a&&a.ended)&&(!h||s&&s.ended)?void 0:n.call(t,new Error("premature close"))},m=function(){t.req.on("finish",l)};return!function(t){return t.setHeader&&"function"==typeof t.abort}(t)?h&&!s&&(t.on("end",u),t.on("close",u)):(t.on("complete",l),t.on("abort",_),t.req?m():t.on("request",m)),function(t){return t.stdio&&Array.isArray(t.stdio)&&3===t.stdio.length}(t)&&t.on("exit",p),t.on("end",f),t.on("finish",l),!1!==e.error&&t.on("error",d),t.on("close",_),function(){t.removeListener("complete",l),t.removeListener("abort",_),t.removeListener("request",m),t.req&&t.req.removeListener("finish",l),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",l),t.removeListener("exit",p),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",_)}};t.exports=o},function(t,e,n){"use strict";var r=n(1).Buffer,i=t.exports;for(var o in i.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"reserved"},i.codes={},i.types){var s=i.types[o];i.codes[s]=o}function a(t){return[0,1,2].map(function(e){return[0,1].map(function(n){return[0,1].map(function(o){var s=new r(1);return s.writeUInt8(i.codes[t]<<i.CMD_SHIFT|(n?i.DUP_MASK:0)|e<<i.QOS_SHIFT|o,0,!0),s})})})}i.CMD_SHIFT=4,i.CMD_MASK=240,i.DUP_MASK=8,i.QOS_MASK=3,i.QOS_SHIFT=1,i.RETAIN_MASK=1,i.LENGTH_MASK=127,i.LENGTH_FIN_MASK=128,i.SESSIONPRESENT_MASK=1,i.SESSIONPRESENT_HEADER=r.from([i.SESSIONPRESENT_MASK]),i.CONNACK_HEADER=r.from([i.codes.connack<<i.CMD_SHIFT]),i.USERNAME_MASK=128,i.PASSWORD_MASK=64,i.WILL_RETAIN_MASK=32,i.WILL_QOS_MASK=24,i.WILL_QOS_SHIFT=3,i.WILL_FLAG_MASK=4,i.CLEAN_SESSION_MASK=2,i.CONNECT_HEADER=r.from([i.codes.connect<<i.CMD_SHIFT]),i.PUBLISH_HEADER=a("publish"),i.SUBSCRIBE_HEADER=a("subscribe"),i.UNSUBSCRIBE_HEADER=a("unsubscribe"),i.ACKS={unsuback:a("unsuback"),puback:a("puback"),pubcomp:a("pubcomp"),pubrel:a("pubrel"),pubrec:a("pubrec")},i.SUBACK_HEADER=r.from([i.codes.suback<<i.CMD_SHIFT]),i.VERSION3=r.from([3]),i.VERSION4=r.from([4]),i.QOS=[0,1,2].map(function(t){return r.from([t])}),i.EMPTY={pingreq:r.from([i.codes.pingreq<<4,0]),pingresp:r.from([i.codes.pingresp<<4,0]),disconnect:r.from([i.codes.disconnect<<4,0])}},function(t,e,n){"use strict";var r=n(44),i=n(1).Buffer,o=i.allocUnsafe(0),s=i.from([0]),a=n(100),c=n(17).nextTick,h=a.cache,u=a.generateNumber,l=a.generateCache,f=v,p=!0;function d(t,e){switch(e.cork&&(e.cork(),c(_,e)),p&&(p=!1,l()),t.cmd){case"connect":return function(t,e){var n=t||{},o=n.protocolId||"MQTT",s=n.protocolVersion||4,a=n.will,c=n.clean,h=n.keepalive||0,u=n.clientId||"",l=n.username,p=n.password;void 0===c&&(c=!0);var d=0;if(!o||"string"!=typeof o&&!i.isBuffer(o))return e.emit("error",new Error("Invalid protocolId")),!1;d+=o.length+2;if(3!==s&&4!==s)return e.emit("error",new Error("Invalid protocol version")),!1;d+=1;if("string"!=typeof u&&!i.isBuffer(u)||!u&&4!==s||!u&&!c){if(s<4)return e.emit("error",new Error("clientId must be supplied before 3.1.1")),!1;if(1*c==0)return e.emit("error",new Error("clientId must be given if cleanSession set to 0")),!1}else d+=u.length+2;if("number"!=typeof h||h<0||h>65535||h%1!=0)return e.emit("error",new Error("Invalid keepalive")),!1;d+=2;if(d+=1,a){if("object"!=typeof a)return e.emit("error",new Error("Invalid will")),!1;if(!a.topic||"string"!=typeof a.topic)return e.emit("error",new Error("Invalid will topic")),!1;if(d+=i.byteLength(a.topic)+2,a.payload&&a.payload){if(!(a.payload.length>=0))return e.emit("error",new Error("Invalid will payload")),!1;"string"==typeof a.payload?d+=i.byteLength(a.payload)+2:d+=a.payload.length+2}else d+=2}var _=!1;if(null!=l){if(!S(l))return e.emit("error",new Error("Invalid username")),!1;_=!0,d+=i.byteLength(l)+2}if(null!=p){if(!_)return e.emit("error",new Error("Username is required to use password")),!1;if(!S(p))return e.emit("error",new Error("Invalid password")),!1;d+=E(p)+2}e.write(r.CONNECT_HEADER),y(e,d),w(e,o),e.write(4===s?r.VERSION4:r.VERSION3);var m=0;m|=null!=l?r.USERNAME_MASK:0,m|=null!=p?r.PASSWORD_MASK:0,m|=a&&a.retain?r.WILL_RETAIN_MASK:0,m|=a&&a.qos?a.qos<<r.WILL_QOS_SHIFT:0,m|=a?r.WILL_FLAG_MASK:0,m|=c?r.CLEAN_SESSION_MASK:0,e.write(i.from([m])),f(e,h),w(e,u),a&&(g(e,a.topic),w(e,a.payload));null!=l&&w(e,l);null!=p&&w(e,p);return!0}(t,e);case"connack":return function(t,e){var n=(t||{}).returnCode;if("number"!=typeof n)return e.emit("error",new Error("Invalid return code")),!1;return e.write(r.CONNACK_HEADER),y(e,2),e.write(t.sessionPresent?r.SESSIONPRESENT_HEADER:s),e.write(i.from([n]))}(t,e);case"publish":return function(t,e){var n=t||{},s=n.qos||0,a=n.retain?r.RETAIN_MASK:0,c=n.topic,h=n.payload||o,u=n.messageId,l=0;if("string"==typeof c)l+=i.byteLength(c)+2;else{if(!i.isBuffer(c))return e.emit("error",new Error("Invalid topic")),!1;l+=c.length+2}i.isBuffer(h)?l+=h.length:l+=i.byteLength(h);if(s&&"number"!=typeof u)return e.emit("error",new Error("Invalid messageId")),!1;s&&(l+=2);e.write(r.PUBLISH_HEADER[s][t.dup?1:0][a?1:0]),y(e,l),f(e,E(c)),e.write(c),s>0&&f(e,u);return e.write(h)}(t,e);case"puback":case"pubrec":case"pubrel":case"pubcomp":case"unsuback":return function(t,e){var n=t||{},i=n.cmd||"puback",o=n.messageId,s=n.dup&&"pubrel"===i?r.DUP_MASK:0,a=0;"pubrel"===i&&(a=1);if("number"!=typeof o)return e.emit("error",new Error("Invalid messageId")),!1;return e.write(r.ACKS[i][a][s][0]),y(e,2),f(e,o)}(t,e);case"subscribe":return function(t,e){var n=t||{},o=n.dup?r.DUP_MASK:0,s=n.messageId,a=n.subscriptions,c=0;if("number"!=typeof s)return e.emit("error",new Error("Invalid messageId")),!1;c+=2;if("object"!=typeof a||!a.length)return e.emit("error",new Error("Invalid subscriptions")),!1;for(var h=0;h<a.length;h+=1){var u=a[h].topic,l=a[h].qos;if("string"!=typeof u)return e.emit("error",new Error("Invalid subscriptions - invalid topic")),!1;if("number"!=typeof l)return e.emit("error",new Error("Invalid subscriptions - invalid qos")),!1;c+=i.byteLength(u)+2+1}e.write(r.SUBSCRIBE_HEADER[1][o?1:0][0]),y(e,c),f(e,s);for(var p=!0,d=0;d<a.length;d++){var _=a[d],m=_.topic,v=_.qos;g(e,m),p=e.write(r.QOS[v])}return p}(t,e);case"suback":return function(t,e){var n=t||{},o=n.messageId,s=n.granted,a=0;if("number"!=typeof o)return e.emit("error",new Error("Invalid messageId")),!1;a+=2;if("object"!=typeof s||!s.length)return e.emit("error",new Error("Invalid qos vector")),!1;for(var c=0;c<s.length;c+=1){if("number"!=typeof s[c])return e.emit("error",new Error("Invalid qos vector")),!1;a+=1}return e.write(r.SUBACK_HEADER),y(e,a),f(e,o),e.write(i.from(s))}(t,e);case"unsubscribe":return function(t,e){var n=t||{},o=n.messageId,s=n.dup?r.DUP_MASK:0,a=n.unsubscriptions,c=0;if("number"!=typeof o)return e.emit("error",new Error("Invalid messageId")),!1;c+=2;if("object"!=typeof a||!a.length)return e.emit("error",new Error("Invalid unsubscriptions")),!1;for(var h=0;h<a.length;h+=1){if("string"!=typeof a[h])return e.emit("error",new Error("Invalid unsubscriptions")),!1;c+=i.byteLength(a[h])+2}e.write(r.UNSUBSCRIBE_HEADER[1][s?1:0][0]),y(e,c),f(e,o);for(var u=!0,l=0;l<a.length;l++)u=g(e,a[l]);return u}(t,e);case"pingreq":case"pingresp":case"disconnect":return function(t,e){return e.write(r.EMPTY[t.cmd])}(t,e);default:return e.emit("error",new Error("Unknown command")),!1}}function _(t){t.uncork()}Object.defineProperty(d,"cacheNumbers",{get:function(){return f===v},set:function(t){t?(h&&0!==Object.keys(h).length||(p=!0),f=v):(p=!1,f=b)}});var m={};function y(t,e){var n=m[e];n||(n=function(t){var e=0,n=0,r=i.allocUnsafe(function(t){return t>=0&&t<128?1:t>=128&&t<16384?2:t>=16384&&t<2097152?3:t>=2097152&&t<268435456?4:0}(t));do{e=t%128|0,(t=t/128|0)>0&&(e|=128),r.writeUInt8(e,n++)}while(t>0);return r}(e),e<16384&&(m[e]=n)),t.write(n)}function g(t,e){var n=i.byteLength(e);f(t,n),t.write(e,"utf8")}function v(t,e){return t.write(h[e])}function b(t,e){return t.write(u(e))}function w(t,e){"string"==typeof e?g(t,e):e?(f(t,e.length),t.write(e)):f(t,0)}function E(t){return t?t instanceof i?t.length:i.byteLength(t):0}function S(t){return"string"==typeof t||t instanceof i}t.exports=d},function(t,e,n){"use strict";var r=n(103);t.exports=function(t,e){var n,i;return e.port=e.port||1883,e.hostname=e.hostname||e.host||"localhost",n=e.port,i=e.hostname,r.createConnection(n,i)}},function(t,e,n){"use strict";var r=!1,i=[];function o(t){r?wx.sendSocketMessage({data:t.buffer||t}):i.push(t)}var s=n(48);function a(t,e){var n="MQIsdp"===e.protocolId&&3===e.protocolVersion?"mqttv3.1":"mqtt";!function(t){t.hostname||(t.hostname="localhost"),t.path||(t.path="/"),t.wsOptions||(t.wsOptions={})}(e);var a=function(t,e){var n="wxs"===t.protocol?"wss":"ws",r=n+"://"+t.hostname+t.path;return t.port&&80!==t.port&&443!==t.port&&(r=n+"://"+t.hostname+":"+t.port+t.path),"function"==typeof t.transformWsUrl&&(r=t.transformWsUrl(r,t,e)),r}(e,t);return s(function(t,e){var n={OPEN:1,CLOSING:2,CLOSED:3,readyState:r?1:0,send:o,close:wx.closeSocket,onopen:null,onmessage:null,onclose:null,onerror:null};return wx.connectSocket({url:t,protocols:e}),wx.onSocketOpen(function(t){n.readyState=n.OPEN,r=!0;for(var e=0;e<i.length;e++)o(i[e]);i=[],n.onopen&&n.onopen.apply(n,arguments)}),wx.onSocketMessage(function(t){n.onmessage&&n.onmessage.apply(n,arguments)}),wx.onSocketClose(function(){n.onclose&&n.onclose.apply(n,arguments),n.readyState=n.CLOSED,r=!1}),wx.onSocketError(function(){n.onerror&&n.onerror.apply(n,arguments),n.readyState=n.CLOSED,r=!1}),n}(a,[n]))}t.exports=function(t,e){if(e.hostname=e.hostname||e.host,!e.hostname)throw new Error("Could not determine host. Specify host manually.");return a(t,e)}},function(t,e,n){"use strict";(function(e,r){var i=n(9).Transform,o=n(105),s=n(107),a=n(1).Buffer;t.exports=function(t,n,c){var h,u,l="browser"===e.title,f=!!r.WebSocket,p=l?function t(e,n,r){if(u.bufferedAmount>_)return void setTimeout(t,m,e,n,r);y&&"string"==typeof e&&(e=a.from(e,"utf8"));try{u.send(e)}catch(t){return r(t)}r()}:function(t,e,n){if(u.readyState!==u.OPEN)return void n();y&&"string"==typeof t&&(t=a.from(t,"utf8"));u.send(t,n)};n&&!Array.isArray(n)&&"object"==typeof n&&(c=n,n=null,("string"==typeof c.protocol||Array.isArray(c.protocol))&&(n=c.protocol));c||(c={});void 0===c.objectMode&&(c.objectMode=!(!0===c.binary||void 0===c.binary));var d=function(t,e,n){var r=new i({objectMode:t.objectMode});return r._write=e,r._flush=n,r}(c,p,function(t){u.close(),t()});c.objectMode||(d._writev=function(t,e){for(var n=new Array(t.length),r=0;r<t.length;r++)"string"==typeof t[r].chunk?n[r]=a.from(t[r],"utf8"):n[r]=t[r].chunk;this._write(a.concat(n),"binary",e)});var _=c.browserBufferSize||524288,m=c.browserBufferTimeout||1e3;"object"==typeof t?u=t:(u=f&&l?new s(t,n):new s(t,n,c)).binaryType="arraybuffer";u.readyState===u.OPEN?h=d:(h=o.obj(),u.onopen=function(){h.setReadable(d),h.setWritable(d),h.emit("connect")});h.socket=u,u.onclose=function(){h.end(),h.destroy()},u.onerror=function(t){h.destroy(t)},u.onmessage=function(t){var e=t.data;e=e instanceof ArrayBuffer?a.from(e):a.from(e,"utf8");d.push(e)},d.on("close",function(){u.close()});var y=!c.objectMode;return h}}).call(this,n(2),n(5))},function(t,e,n){"use strict";(function(e){var r=n(48),i=n(24),o=["rejectUnauthorized","ca","cert","key","pfx","passphrase"],s="browser"===e.title;function a(t,e){var n="MQIsdp"===e.protocolId&&3===e.protocolVersion?"mqttv3.1":"mqtt";!function(t){t.hostname||(t.hostname="localhost"),t.port||("wss"===t.protocol?t.port=443:t.port=80),t.path||(t.path="/"),t.wsOptions||(t.wsOptions={}),s||"wss"!==t.protocol||o.forEach(function(e){t.hasOwnProperty(e)&&!t.wsOptions.hasOwnProperty(e)&&(t.wsOptions[e]=t[e])})}(e);var i=function(t,e){var n=t.protocol+"://"+t.hostname+":"+t.port+t.path;return"function"==typeof t.transformWsUrl&&(n=t.transformWsUrl(n,t,e)),n}(e,t);return r(i,[n],e.wsOptions)}t.exports=s?function(t,e){if(e.hostname||(e.hostname=e.host),!e.hostname){if("undefined"==typeof document)throw new Error("Could not determine host. Specify host manually.");var n=i.parse(document.URL);e.hostname=n.hostname,e.port||(e.port=n.port)}return a(t,e)}:function(t,e){return a(t,e)}}).call(this,n(2))},function(t,e,n){"use strict";var r=n(0),i=n(73),o=n(32),s=n(1).Buffer,a=n(84),c=n(86),h=n(87),u=s.alloc(128);function l(t,e){o.call(this,"digest"),"string"==typeof e&&(e=s.from(e));var n="sha512"===t||"sha384"===t?128:64;(this._alg=t,this._key=e,e.length>n)?e=("rmd160"===t?new c:h(t)).update(e).digest():e.length<n&&(e=s.concat([e,u],n));for(var r=this._ipad=s.allocUnsafe(n),i=this._opad=s.allocUnsafe(n),a=0;a<n;a++)r[a]=54^e[a],i[a]=92^e[a];this._hash="rmd160"===t?new c:h(t),this._hash.update(r)}r(l,o),l.prototype._update=function(t){this._hash.update(t)},l.prototype._final=function(){var t=this._hash.digest();return("rmd160"===this._alg?new c:h(this._alg)).update(this._opad).update(t).digest()},t.exports=function(t,e){return"rmd160"===(t=t.toLowerCase())||"ripemd160"===t?new l("rmd160",e):"md5"===t?new i(a,e):new l(t,e)}},function(t,e,n){"use strict";(function(e){var r=n(92),i=n(42),o=n(24),s=n(27),a={};function c(t,e){if("object"!=typeof t||e||(e=t,t=null),e=e||{},t){var n=o.parse(t,!0);if(null!=n.port&&(n.port=Number(n.port)),null===(e=s(n,e)).protocol)throw new Error("Missing protocol");e.protocol=e.protocol.replace(/:$/,"")}if(function(t){var e;t.auth&&((e=t.auth.match(/^(.+):(.+)$/))?(t.username=e[1],t.password=e[2]):t.username=t.auth)}(e),e.query&&"string"==typeof e.query.clientId&&(e.clientId=e.query.clientId),e.cert&&e.key){if(!e.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss","wxs"].indexOf(e.protocol))switch(e.protocol){case"mqtt":e.protocol="mqtts";break;case"ws":e.protocol="wss";break;case"wx":e.protocol="wxs";break;default:throw new Error('Unknown protocol for secure connection: "'+e.protocol+'"!')}}if(!a[e.protocol]){var i=-1!==["mqtts","wss"].indexOf(e.protocol);e.protocol=["mqtt","mqtts","ws","wss","wx","wxs"].filter(function(t,e){return(!i||e%2!=0)&&"function"==typeof a[t]})[0]}if(!1===e.clean&&!e.clientId)throw new Error("Missing clientId for unclean clients");return e.protocol&&(e.defaultProtocol=e.protocol),new r(function(t){return e.servers&&(t._reconnectCount&&t._reconnectCount!==e.servers.length||(t._reconnectCount=0),e.host=e.servers[t._reconnectCount].host,e.port=e.servers[t._reconnectCount].port,e.protocol=e.servers[t._reconnectCount].protocol?e.servers[t._reconnectCount].protocol:e.defaultProtocol,e.hostname=e.host,t._reconnectCount++),a[e.protocol](t,e)},e)}"browser"!==e.title?(a.mqtt=n(46),a.tcp=n(46),a.ssl=n(28),a.tls=n(28),a.mqtts=n(28)):(a.wx=n(47),a.wxs=n(47)),a.ws=n(49),a.wss=n(49),t.exports=c,t.exports.connect=c,t.exports.MqttClient=r,t.exports.Store=i}).call(this,n(2))},function(t,e,n){"use strict";(function(e,r,i){var o=n(12),s=n(16),a=n(14),c=n(30),h=n(21),u=n(22),l=n(60),f=n(31),p=n(20),d=n(20),_=n(6).EventEmitter;function m(t){return t.get_id_string?t.get_id_string():t.localAddress+":"+t.localPort+" -> "+t.remoteAddress+":"+t.remotePort}function y(t,e){if(t){var n,r=t;return function(i){return n!==i&&(r=t,n=i),r--?e(i):-1}}return e}function g(t){if(void 0===t.transport||"tcp"===t.transport)return p.connect;if("tls"===t.transport||"ssl"===t.transport)return d.connect;throw Error("Unrecognised transport: "+t.transport)}var v=["container_id","hostname","max_frame_size","channel_max","idle_time_out","outgoing_locales","incoming_locales","offered_capabilities","desired_capabilities","properties"];function b(t){return function(){return this.remote.open?this.remote.open[t]:void 0}}var w=1,E=function(t,e){if(this.options={},t){for(var n in t)this.options[n]=t[n];"tls"!==t.transport&&"ssl"!==t.transport||void 0!==t.servername||void 0===t.host||(this.options.servername=t.host)}if(this.container=e,this.options.id||(this.options.id="connection-"+w++),this.options.container_id||(this.options.container_id=e?e.id:h.generate_uuid()),!this.options.connection_details){var r=this;this.options.connection_details=function(){return function(t){var e={};return e.connect=t.connect?t.connect:g(t),e.host=t.host?t.host:"localhost",e.port=t.port?t.port:5672,e.options=t,e}(r.options)}}var i=this.get_option("reconnect",!0);if("boolean"==typeof i&&i){var o=this.get_option("initial_reconnect_delay",100),a=this.get_option("max_reconnect_delay",6e4);this.options.reconnect=y(this.get_option("reconnect_limit"),function(t,e){var n,r=t;return function(i){n!==i&&(r=t,n=i);var o=r,s=2*r;return r=e>s?s:e,o}}(o,a))}else if("number"==typeof i){var c=this.options.reconnect;this.options.reconnect=y(this.get_option("reconnect_limit"),function(){return c})}for(var l in this.registered=!1,this.state=new u,this.local_channel_map={},this.remote_channel_map={},this.local={},this.remote={},this.local.open=s.open(this.options),this.local.close=s.close({}),this.session_policy=function(t){var e=null;return{get_session:function(){return e||(e=t.create_session()).begin(),e}}}(this),this.amqp_transport=new f(this.options.id,0,s.TYPE_AMQP,this),this.sasl_transport=void 0,this.transport=this.amqp_transport,this.conn_established_counter=0,this.heartbeat_out=void 0,this.heartbeat_in=void 0,this.abort_idle=!1,this.socket_ready=!1,this.scheduled_reconnect=void 0,this.default_sender=void 0,this.closed_with_non_fatal_error=!1,v){var p=v[l];Object.defineProperty(this,p,{get:b(p)})}Object.defineProperty(this,"error",{get:function(){return this.remote.close?this.remote.close.error:void 0}})};function S(t){return t<16?"0x0"+Number(t).toString(16):"0x"+Number(t).toString(16)}function k(t){E.prototype["on_"+t]=function(e){var n=this.remote_channel_map[e.channel];if(!n)throw new o.ProtocolError(t+" received on invalid channel "+e.channel);n["on_"+t](e)}}E.prototype=Object.create(_.prototype),E.prototype.constructor=E,E.prototype.dispatch=function(t){return a.events("Connection got event: %s",t),this.listeners(t).length?(_.prototype.emit.apply(this,arguments),!0):!!this.container&&this.container.dispatch.apply(this.container,arguments)},E.prototype._disconnect=function(){for(var t in this.state.disconnected(),this.local_channel_map)this.local_channel_map[t]._disconnect();this.socket_ready=!1},E.prototype._reconnect=function(){for(var t in this.abort_idle&&(this.abort_idle=!1,this.local.close.error=void 0,this.state=new u,this.state.open()),this.amqp_transport=new f(this.options.id,0,s.TYPE_AMQP,this),this.sasl_transport=void 0,this.transport=this.amqp_transport,this.remote={},this.state.reconnect(),this.remote_channel_map={},this.local_channel_map)this.local_channel_map[t]._reconnect()},E.prototype.connect=function(){return this.is_server=!1,this._connect(this.options.connection_details(this.conn_established_counter)),this.open(),this},E.prototype.reconnect=function(){return this.scheduled_reconnect=void 0,a.reconnect("reconnecting..."),this._reconnect(),this._connect(this.options.connection_details(this.conn_established_counter)),e.nextTick(this._process.bind(this)),this},E.prototype._connect=function(t){return t.connect?this.init(t.connect(t.port,t.host,t.options,this.connected.bind(this))):this.init(g(t)(t.port,t.host,t.options,this.connected.bind(this))),this},E.prototype.accept=function(t){return this.is_server=!0,a.io("[%s] client accepted: %s",this.id,m(t)),this.socket_ready=!0,this.init(t)},E.prototype.init=function(t){if(this.socket=t,this.get_option("tcp_no_delay",!1)&&this.socket.setNoDelay&&this.socket.setNoDelay(!0),this.socket.on("data",this.input.bind(this)),this.socket.on("error",this.on_error.bind(this)),this.socket.on("end",this.eof.bind(this)),this.is_server){var e;if(this.container&&Object.getOwnPropertyNames(this.container.sasl_server_mechanisms).length&&(e=this.container.sasl_server_mechanisms),this.socket.encrypted&&this.socket.authorized&&this.get_option("enable_sasl_external",!1)&&(e=c.server_add_external(e?h.clone(e):{})),e)void 0===e.ANONYMOUS||this.get_option("require_sasl",!1)?this.sasl_transport=new c.Server(this,e):this.sasl_transport=new c.Selective(this,e);else if(!this.get_option("disable_sasl",!1)){var n=c.server_mechanisms();n.enable_anonymous(),this.sasl_transport=new c.Selective(this,n)}}else{var r=this.get_option("sasl_mechanisms");if(!r){var i=this.get_option("username"),o=this.get_option("password"),s=this.get_option("token");i&&(r=c.client_mechanisms(),o?r.enable_plain(i,o):s?r.enable_xoauth2(i,s):r.enable_anonymous(i))}this.socket.encrypted&&this.options.cert&&this.get_option("enable_sasl_external",!1)&&(r||(r=c.client_mechanisms()),r.enable_external()),r&&(this.sasl_transport=new c.Client(this,r,this.options.sasl_init_hostname||this.options.servername||this.options.host))}return this.transport=this.sasl_transport?this.sasl_transport:this.amqp_transport,this},E.prototype.attach_sender=function(t){return this.session_policy.get_session().attach_sender(t)},E.prototype.open_sender=E.prototype.attach_sender,E.prototype.attach_receiver=function(t){return this.get_option("tcp_no_delay",!0)&&this.socket.setNoDelay&&this.socket.setNoDelay(!0),this.session_policy.get_session().attach_receiver(t)},E.prototype.open_receiver=E.prototype.attach_receiver,E.prototype.get_option=function(t,e){return void 0!==this.options[t]?this.options[t]:this.container?this.container.get_option(t,e):e},E.prototype.send=function(t){return void 0===this.default_sender&&(this.default_sender=this.open_sender({target:{}})),this.default_sender.send(t)},E.prototype.connected=function(){this.socket_ready=!0,this.conn_established_counter++,a.io("[%s] connected %s",this.options.id,m(this.socket)),this.output()},E.prototype.sasl_failed=function(t){this.transport_error=new o.ConnectionError(t,"amqp:unauthorized-access",this),this._handle_error()},E.prototype._is_fatal=function(t){return this.get_option("non_fatal_errors",["amqp:connection:forced"]).indexOf(t)<0},E.prototype._handle_error=function(){var t=this.get_error();if(t){var e=this.dispatch("connection_error",this._context({error:t}));return e=this.dispatch("connection_close",this._context({error:t}))||e,this._is_fatal(t.condition)?e||this.dispatch("error",new o.ConnectionError(t.description,t.condition,this)):this.closed_with_non_fatal_error=!0,!0}return!1},E.prototype.get_error=function(){return this.transport_error?this.transport_error:this.remote.close&&this.remote.close.error?new o.ConnectionError(this.remote.close.error.description,this.remote.close.error.condition,this):void 0},E.prototype._get_peer_details=function(){var t="";return this.remote.open&&this.remote.open.container&&(t+=this.remote.open.container+" "),this.remote.open&&this.remote.open.properties&&(t+=JSON.stringify(this.remote.open.properties)),t},E.prototype.output=function(){try{this.socket&&this.socket_ready&&(this.heartbeat_out&&clearTimeout(this.heartbeat_out),this.transport.write(this.socket),(this.is_closed()&&this.state.has_settled()||this.abort_idle||this.transport_error)&&!this.transport.has_writes_pending()?this.socket.end():this.is_open()&&this.remote.open.idle_time_out&&(this.heartbeat_out=setTimeout(this._write_frame.bind(this),this.remote.open.idle_time_out/2)))}catch(t){"ProtocolError"===t.name?(r.error("["+this.options.id+"] error on write: "+t+" "+this._get_peer_details()+" "+t.name),this.dispatch("protocol_error",t)||r.error("["+this.options.id+"] error on write: "+t+" "+this._get_peer_details())):this.dispatch("error",t),this.socket.end()}},E.prototype.input=function(t){var e;try{this.heartbeat_in&&clearTimeout(this.heartbeat_in),a.io("[%s] read %d bytes",this.options.id,t.length),this.previous_input?(e=i.concat([this.previous_input,t],this.previous_input.length+t.length),this.previous_input=null):e=t;var n=this.transport.read(e,this);n<e.length&&(this.previous_input=e.slice(n)),this.local.open.idle_time_out&&(this.heartbeat_in=setTimeout(this.idle.bind(this),this.local.open.idle_time_out)),this.transport.has_writes_pending()?this.output():this.is_closed()&&this.state.has_settled()?this.socket.end():this.is_open()&&this.remote.open.idle_time_out&&!this.heartbeat_out&&(this.heartbeat_out=setTimeout(this._write_frame.bind(this),this.remote.open.idle_time_out/2))}catch(t){"ProtocolError"===t.name?this.dispatch("protocol_error",t)||r.error("["+this.options.id+"] error on read: "+t+" "+this._get_peer_details()+" (buffer:"+function(t){for(var e=[],n=0;n<t.length;n++)e.push(S(t[n]));return e.join(",")}(e)+")"):this.dispatch("error",t),this.socket.end()}},E.prototype.idle=function(){this.is_open()&&(this.abort_idle=!0,this.local.close.error={condition:"amqp:resource-limit-exceeded",description:"max idle time exceeded"},this.close())},E.prototype.on_error=function(t){this._disconnected(t)},E.prototype.eof=function(){this._disconnected()},E.prototype._disconnected=function(t){if(this.heartbeat_out&&clearTimeout(this.heartbeat_out),this.heartbeat_in&&clearTimeout(this.heartbeat_in),this.closed_with_non_fatal_error&&(this.closed_with_non_fatal_error=!1,this.options.reconnect&&this.open()),!this.is_closed()&&void 0===this.scheduled_reconnect){this._disconnect();var e={};if(t&&(e.error=t),!this.is_server&&!this.transport_error&&this.options.reconnect){var n=this.options.reconnect(this.conn_established_counter);n>=0?(a.reconnect("Scheduled reconnect in "+n+"ms"),this.scheduled_reconnect=setTimeout(this.reconnect.bind(this),n),e.reconnecting=!0):e.reconnecting=!1}this.dispatch("disconnected",this._context(e))||r.warn("["+this.options.id+"] disconnected %s",e.error||"")}},E.prototype.open=function(){this.state.open()&&this._register()},E.prototype.close=function(t){t&&(this.local.close.error=t),this.state.close()&&this._register()},E.prototype.is_open=function(){return this.state.is_open()},E.prototype.is_remote_open=function(){return this.state.remote_open},E.prototype.is_closed=function(){return this.state.is_closed()},E.prototype.create_session=function(){for(var t=0;this.local_channel_map[t];)t++;var e=new l(this,t);return this.local_channel_map[t]=e,e},E.prototype.find_sender=function(t){return this.find_link(h.sender_filter(t))},E.prototype.find_receiver=function(t){return this.find_link(h.receiver_filter(t))},E.prototype.find_link=function(t){for(var e in this.local_channel_map){var n=this.local_channel_map[e].find_link(t);if(n)return n}},E.prototype.each_receiver=function(t,e){this.each_link(t,h.receiver_filter(e))},E.prototype.each_sender=function(t,e){this.each_link(t,h.sender_filter(e))},E.prototype.each_link=function(t,e){for(var n in this.local_channel_map){this.local_channel_map[n].each_link(t,e)}},E.prototype.on_open=function(t){if(!this.state.remote_opened())throw new o.ProtocolError("Open already received");this.remote.open=t.performative,this.open(),this.dispatch("connection_open",this._context())},E.prototype.on_close=function(t){if(!this.state.remote_closed())throw new o.ProtocolError("Close already received");this.remote.close=t.performative,this.close(),this.remote.close.error?this._handle_error():this.dispatch("connection_close",this._context()),this.heartbeat_out&&clearTimeout(this.heartbeat_out)},E.prototype._register=function(){this.registered||(this.registered=!0,e.nextTick(this._process.bind(this)))},E.prototype._process=function(){this.registered=!1;do{for(var t in this.state.need_open()&&this._write_open(),this.local_channel_map)this.local_channel_map[t]._process();this.state.need_close()&&this._write_close()}while(!this.state.has_settled())},E.prototype._write_frame=function(t,e,n){this.amqp_transport.encode(s.amqp_frame(t,e,n)),this.output()},E.prototype._write_open=function(){this._write_frame(0,this.local.open)},E.prototype._write_close=function(){this._write_frame(0,this.local.close)},E.prototype.on_begin=function(t){var e;if(null===t.performative.remote_channel||void 0===t.performative.remote_channel)(e=this.create_session()).local.begin.remote_channel=t.channel;else if(!(e=this.local_channel_map[t.performative.remote_channel]))throw new o.ProtocolError("Invalid value for remote channel "+t.performative.remote_channel);e.on_begin(t),this.remote_channel_map[t.channel]=e},E.prototype.get_peer_certificate=function(){return this.socket&&this.socket.getPeerCertificate?this.socket.getPeerCertificate():void 0},E.prototype.get_tls_socket=function(){return!this.socket||"tls"!==this.options.transport&&"ssl"!==this.options.transport?void 0:this.socket},E.prototype._context=function(t){var e=t||{};return e.connection=this,this.container&&(e.container=this.container),e},E.prototype.remove_session=function(t){delete this.remote_channel_map[t.remote.channel],delete this.local_channel_map[t.local.channel]},k("end"),k("attach"),k("detach"),k("transfer"),k("disposition"),k("flow"),t.exports=E}).call(this,n(2),n(4),n(3).Buffer)},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function r(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function i(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var o=n(11),s=Object.prototype.hasOwnProperty,a=Array.prototype.slice,c="foo"===function(){}.name;function h(t){return Object.prototype.toString.call(t)}function u(t){return!i(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var l=t.exports=y,f=/\s*function\s+([^\(\s]*)\s*/;function p(t){if(o.isFunction(t)){if(c)return t.name;var e=t.toString().match(f);return e&&e[1]}}function d(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function _(t){if(c||!o.isFunction(t))return o.inspect(t);var e=p(t);return"[Function"+(e?": "+e:"")+"]"}function m(t,e,n,r,i){throw new l.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function y(t,e){t||m(t,!0,e,"==",l.ok)}function g(t,e,n,s){if(t===e)return!0;if(i(t)&&i(e))return 0===r(t,e);if(o.isDate(t)&&o.isDate(e))return t.getTime()===e.getTime();if(o.isRegExp(t)&&o.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(u(t)&&u(e)&&h(t)===h(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===r(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(i(t)!==i(e))return!1;var c=(s=s||{actual:[],expected:[]}).actual.indexOf(t);return-1!==c&&c===s.expected.indexOf(e)||(s.actual.push(t),s.expected.push(e),function(t,e,n,r){if(null===t||void 0===t||null===e||void 0===e)return!1;if(o.isPrimitive(t)||o.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=v(t),s=v(e);if(i&&!s||!i&&s)return!1;if(i)return t=a.call(t),e=a.call(e),g(t,e,n);var c,h,u=E(t),l=E(e);if(u.length!==l.length)return!1;for(u.sort(),l.sort(),h=u.length-1;h>=0;h--)if(u[h]!==l[h])return!1;for(h=u.length-1;h>=0;h--)if(c=u[h],!g(t[c],e[c],n,r))return!1;return!0}(t,e,n,s))}return n?t===e:t==e}function v(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function b(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function w(t,e,n,r){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&m(i,n,"Missing expected exception"+r);var s="string"==typeof r,a=!t&&o.isError(i),c=!t&&i&&!n;if((a&&s&&b(i,n)||c)&&m(i,n,"Got unwanted exception"+r),t&&i&&n&&!b(i,n)||!t&&i)throw i}l.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return d(_(t.actual),128)+" "+t.operator+" "+d(_(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=p(e),o=r.indexOf("\n"+i);if(o>=0){var s=r.indexOf("\n",o+1);r=r.substring(s+1)}this.stack=r}}},o.inherits(l.AssertionError,Error),l.fail=m,l.ok=y,l.equal=function(t,e,n){t!=e&&m(t,e,n,"==",l.equal)},l.notEqual=function(t,e,n){t==e&&m(t,e,n,"!=",l.notEqual)},l.deepEqual=function(t,e,n){g(t,e,!1)||m(t,e,n,"deepEqual",l.deepEqual)},l.deepStrictEqual=function(t,e,n){g(t,e,!0)||m(t,e,n,"deepStrictEqual",l.deepStrictEqual)},l.notDeepEqual=function(t,e,n){g(t,e,!1)&&m(t,e,n,"notDeepEqual",l.notDeepEqual)},l.notDeepStrictEqual=function t(e,n,r){g(e,n,!0)&&m(e,n,r,"notDeepStrictEqual",t)},l.strictEqual=function(t,e,n){t!==e&&m(t,e,n,"===",l.strictEqual)},l.notStrictEqual=function(t,e,n){t===e&&m(t,e,n,"!==",l.notStrictEqual)},l.throws=function(t,e,n){w(!0,t,e,n)},l.doesNotThrow=function(t,e,n){w(!1,t,e,n)},l.ifError=function(t){if(t)throw t};var E=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n(5))},function(t,e){t.exports=function(){return(new Date).getTime()}},function(t,e,n){"use strict";e.byteLength=function(t){var e=h(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=h(t),r=n[0],s=n[1],a=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,s)),c=0,u=s>0?r-4:r,l=0;l<u;l+=4)e=i[t.charCodeAt(l)]<<18|i[t.charCodeAt(l+1)]<<12|i[t.charCodeAt(l+2)]<<6|i[t.charCodeAt(l+3)],a[c++]=e>>16&255,a[c++]=e>>8&255,a[c++]=255&e;2===s&&(e=i[t.charCodeAt(l)]<<2|i[t.charCodeAt(l+1)]>>4,a[c++]=255&e);1===s&&(e=i[t.charCodeAt(l)]<<10|i[t.charCodeAt(l+1)]<<4|i[t.charCodeAt(l+2)]>>2,a[c++]=e>>8&255,a[c++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(l(t,s,s+16383>a?a:s+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function u(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function l(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(u(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,h=c>>1,u=-7,l=n?i-1:0,f=n?-1:1,p=t[e+l];for(l+=f,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+t[e+l],l+=f,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+t[e+l],l+=f,u-=8);if(0===o)o=1-h;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=h}return(p?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,c,h=8*o-i-1,u=(1<<h)-1,l=u>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,_=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+l>=1?f/c:f*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=u?(a=0,s=u):s+l>=1?(a=(e*c-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,h+=i;h>0;t[n+p]=255&s,p+=d,s/=256,h-=8);t[n+p-d]|=128*_}},function(t,e,n){(function(r){function i(t){var n;function i(){if(i.enabled){var t=i,o=+new Date,s=o-(n||o);t.diff=s,t.prev=n,t.curr=o,n=o;for(var a=new Array(arguments.length),c=0;c<a.length;c++)a[c]=arguments[c];a[0]=e.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var h=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;h++;var i=e.formatters[r];if("function"==typeof i){var o=a[h];n=i.call(t,o),a.splice(h,1),h--}return n}),e.formatArgs.call(t,a),(i.log||e.log||r.log.bind(r)).apply(t,a)}}return i.namespace=t,i.enabled=e.enabled(t),i.useColors=e.useColors(),i.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),i.destroy=o,"function"==typeof e.init&&e.init(i),e.instances.push(i),i}function o(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=i.debug=i.default=i).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var o=e.instances[n];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(59),e.instances=[],e.names=[],e.skips=[],e.formatters={}}).call(this,n(4))},function(t,e){var n=1e3,r=60*n,i=60*r,o=24*i,s=365.25*o;function a(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var a=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(t);if("number"===c&&!1===isNaN(t))return e.long?function(t){return a(t,o,"day")||a(t,i,"hour")||a(t,r,"minute")||a(t,n,"second")||t+" ms"}(t):function(t){if(t>=o)return Math.round(t/o)+"d";if(t>=i)return Math.round(t/i)+"h";if(t>=r)return Math.round(t/r)+"m";if(t>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){"use strict";(function(e,r){var i=n(16),o=n(61),s=n(14),a=n(23),c=n(13),h=n(21),u=n(22),l=n(6).EventEmitter;function f(t,e,n){Error.call(this),Error.captureStackTrace(this,this.constructor),this.message=t,this.condition=e,this.description=t,this.session=n}n(11).inherits(f,Error);var p=function(t){this.capacity=t,this.size=0,this.head=0,this.tail=0,this.entries=[]};function d(t){var e,n,r,o,s;for(o=0;o<t.length;o++)s=t[o],void 0===e&&(e=s,n=s,r=s.id),a.are_outcomes_equivalent(n.state,s.state)&&n.settled===s.settled&&r===s.id?(n.id!==s.id&&(n=s),r++):(e.link.session.output(i.disposition({role:e.link.is_receiver(),first:e.id,last:n.id,state:e.state,settled:e.settled})),e=s,n=s,r=s.id);void 0!==e&&void 0!==n&&e.link.session.output(i.disposition({role:e.link.is_receiver(),first:e.id,last:n.id,state:e.state,settled:e.settled}))}p.prototype.available=function(){return this.capacity-this.size},p.prototype.push=function(t){if(!(this.size<this.capacity))throw Error("circular buffer overflow: head="+this.head+" tail="+this.tail+" size="+this.size+" capacity="+this.capacity);this.entries[this.tail]=t,this.tail=(this.tail+1)%this.capacity,this.size++},p.prototype.pop_if=function(t){for(var e=0;this.size&&t(this.entries[this.head]);)this.entries[this.head]=void 0,this.head=(this.head+1)%this.capacity,this.size--,e++;return e},p.prototype.by_id=function(t){if(this.size>0){var e=t-this.entries[this.head].id;if(e<this.size)return this.entries[(this.head+e)%this.capacity]}},p.prototype.get_head=function(){return this.size>0?this.entries[this.head]:void 0},p.prototype.get_tail=function(){return this.size>0?this.entries[(this.head+this.size-1)%this.capacity]:void 0};var _=function(t){this.deliveries=new p(2048),this.updated=[],this.pending_dispositions=[],this.next_delivery_id=0,this.next_pending_delivery=0,this.next_transfer_id=0,this.window=c.MAX_UINT,this.remote_next_transfer_id=void 0,this.remote_window=void 0,this.connection=t};_.prototype.available=function(){return this.deliveries.available()},_.prototype.compute_max_payload=function(t){return this.connection.max_frame_size?this.connection.max_frame_size-(50+t.length):void 0},_.prototype.send=function(t,e,n,r){var i=[],o=this.compute_max_payload(e);if(o&&n.length>o)for(var s=0;s<n.length;){var a=Math.min(s+o,n.length);i.push(n.slice(s,a)),s=a}else i.push(n);var c={id:this.next_delivery_id++,tag:e,link:t,data:i,format:r||0,sent:!1,settled:!1,state:void 0,remote_settled:!1,remote_state:void 0},h=this;return c.update=function(t,e){h.update(c,t,e)},this.deliveries.push(c),c},_.prototype.on_begin=function(t){this.remote_window=t.incoming_window},_.prototype.on_flow=function(t){this.remote_next_transfer_id=t.next_incoming_id,this.remote_window=t.incoming_window},_.prototype.on_disposition=function(t){for(var e=t.last?t.last:t.first,n=t.first;n<=e;n++){var r=this.deliveries.by_id(n);if(r&&!r.remote_settled){var i=!1;t.settled&&(r.remote_settled=t.settled,i=!0),t.state&&t.state!==r.remote_state&&(r.remote_state=a.unwrap_outcome(t.state),i=!0),i&&this.updated.push(r)}}},_.prototype.update=function(t,e,n){t&&(t.settled=e,void 0!==n&&(t.state=n),t.remote_settled||this.pending_dispositions.push(t),t.link.connection._register())},_.prototype.transfer_window=function(){return this.remote_window?this.remote_window-(this.next_transfer_id-this.remote_next_transfer_id):0},_.prototype.process=function(){for(var t;this.next_pending_delivery<this.next_delivery_id;){if(!(t=this.deliveries.by_id(this.next_pending_delivery))){e.error("ERROR: Next pending delivery not found: "+this.next_pending_delivery);break}if(!t.link.has_credit()){s.flow("Link has no credit");break}if(!(this.transfer_window()>=t.data.length)){s.flow("Incoming window of peer preventing sending further transfers: remote_window=%d, remote_next_transfer_id=%d, next_transfer_id=%d",this.remote_window,this.remote_next_transfer_id,this.next_transfer_id);break}this.window-=t.data.length;for(var n=0;n<t.data.length;n++){this.next_transfer_id++;var r=n+1<t.data.length,o=i.transfer({handle:t.link.local.handle,message_format:t.format,delivery_id:t.id,delivery_tag:t.tag,settled:t.settled,more:r});t.link.session.output(o,t.data[n])}t.link.credit--,t.link.delivery_count++,this.next_pending_delivery++}for(n=0;n<this.updated.length;n++)(t=this.updated[n]).remote_state&&t.remote_state.constructor.composite_type&&t.link.dispatch(t.remote_state.constructor.composite_type,t.link._context({delivery:t})),t.remote_settled&&t.link.dispatch("settled",t.link._context({delivery:t}));this.updated=[],this.pending_dispositions.length&&(d(this.pending_dispositions),this.pending_dispositions=[]),this.deliveries.pop_if(function(t){return t.settled&&t.remote_settled})};var m=function(){this.deliveries=new p(2048),this.updated=[],this.next_transfer_id=0,this.next_delivery_id=void 0,Object.defineProperty(this,"window",{get:function(){return this.deliveries.available()}}),this.remote_next_transfer_id=void 0,this.remote_window=void 0,this.max_transfer_id=this.next_transfer_id+this.window};m.prototype.update=function(t,e,n){t&&(t.settled=e,void 0!==n&&(t.state=n),t.remote_settled||this.updated.push(t),t.link.connection._register())},m.prototype.on_transfer=function(t,e){if(this.next_transfer_id++,!e.is_remote_open())throw Error("transfer after detach");var n,i;void 0===this.next_delivery_id&&(this.next_delivery_id=t.performative.delivery_id);var o=this.deliveries.get_tail();if(o&&o.incomplete){if(h.is_defined(t.performative.delivery_id)&&this.next_delivery_id!==t.performative.delivery_id)throw Error("frame sequence error: delivery "+this.next_delivery_id+" not complete, got "+t.performative.delivery_id);n=o,i=r.concat([n.data,t.payload],n.data.length+t.payload.length)}else{if(this.next_delivery_id!==t.performative.delivery_id)throw Error("frame sequence error: expected "+this.next_delivery_id+", got "+t.performative.delivery_id);var s=this;(n={id:t.performative.delivery_id,tag:t.performative.delivery_tag,format:t.performative.message_format,link:e,settled:!1,state:void 0,remote_settled:void 0!==t.performative.settled&&t.performative.settled,remote_state:t.performative.state}).update=function(t,r){var i=t;void 0===i&&(i=1!==e.local.attach.rcv_settle_mode),s.update(n,i,r)},n.accept=function(){this.update(void 0,a.accepted().described())},n.release=function(t){t?this.update(void 0,a.modified(t).described()):this.update(void 0,a.released().described())},n.reject=function(t){this.update(!0,a.rejected({error:t}).described())},n.modified=function(t){this.update(!0,a.modified(t).described())},this.deliveries.push(n),i=t.payload}if(n.incomplete=t.performative.more,n.incomplete)n.data=i;else{e.credit--,e.delivery_count++,this.next_delivery_id++;var c=0===n.format?{message:a.decode(i),delivery:n}:{message:i,delivery:n,format:n.format};e.dispatch("message",e._context(c))}},m.prototype.process=function(t){this.updated.length>0&&(d(this.updated),this.updated=[]),this.deliveries.pop_if(function(t){return t.settled}),this.max_transfer_id-this.next_transfer_id<this.window/2&&t._write_flow()},m.prototype.on_begin=function(t){this.remote_window=t.outgoing_window,this.remote_next_transfer_id=t.next_outgoing_id},m.prototype.on_flow=function(t){this.remote_next_transfer_id=t.next_outgoing_id,this.remote_window=t.outgoing_window},m.prototype.on_disposition=function(t){for(var e=t.last?t.last:t.first,n=t.first;n<=e;n++){var r=this.deliveries.by_id(n);r&&!r.remote_settled&&t.settled&&(r.remote_settled=t.settled,r.link.dispatch("settled",r.link._context({delivery:r})))}};var y=function(t,e){this.connection=t,this.outgoing=new _(t),this.incoming=new m,this.state=new u,this.local={channel:e,handles:{}},this.local.begin=i.begin({next_outgoing_id:this.outgoing.next_transfer_id,incoming_window:this.incoming.window,outgoing_window:this.outgoing.window}),this.local.end=i.end(),this.remote={handles:{}},this.links={},this.options={},Object.defineProperty(this,"error",{get:function(){return this.remote.end?this.remote.end.error:void 0}})};function g(t,e,n,r){var i=Object.create(r||{});"string"==typeof e?i[n]=e:e&&function t(e,n){for(var r in n)"properties"===r&&e.properties?t(e.properties,n.properties):e[r]=n[r]}(i,e),i.name||(i.name=h.generate_uuid());var o=t(i.name,i);for(var s in{source:0,target:0})i[s]&&("string"==typeof i[s]&&(i[s]={address:i[s]}),o["set_"+s](i[s]));return o.is_sender()&&void 0===i.source&&(i.source=o.set_source({})),o.is_receiver()&&void 0===i.target&&(i.target=o.set_target({})),o.attach(),o}(y.prototype=Object.create(l.prototype)).constructor=y,y.prototype._disconnect=function(){for(var t in this.state.disconnected(),this.links)this.links[t]._disconnect()},y.prototype._reconnect=function(){for(var t in this.state.reconnect(),this.outgoing=new _(this.connection),this.incoming=new m,this.remote={handles:{}},this.links)this.links[t]._reconnect()},y.prototype.dispatch=function(t){return s.events("Session got event: %s",t),this.listeners(t).length?(l.prototype.emit.apply(this,arguments),!0):this.connection.dispatch.apply(this.connection,arguments)},y.prototype.output=function(t,e){this.connection._write_frame(this.local.channel,t,e)},y.prototype.create_sender=function(t,e){return this.create_link(t,o.Sender,e)},y.prototype.create_receiver=function(t,e){return this.create_link(t,o.Receiver,e)},y.prototype.get_option=function(t,e){return void 0!==this.options[t]?this.options[t]:this.connection.get_option(t,e)},y.prototype.attach_sender=function(t){return g(this.create_sender.bind(this),t,"target",this.get_option("sender_options",{}))},y.prototype.open_sender=y.prototype.attach_sender,y.prototype.attach_receiver=function(t){return g(this.create_receiver.bind(this),t,"source",this.get_option("receiver_options",{}))},y.prototype.open_receiver=y.prototype.attach_receiver,y.prototype.find_sender=function(t){return this.find_link(h.sender_filter(t))},y.prototype.find_receiver=function(t){return this.find_link(h.receiver_filter(t))},y.prototype.find_link=function(t){for(var e in this.links){var n=this.links[e];if(t(n))return n}},y.prototype.each_receiver=function(t,e){this.each_link(h.receiver_filter(e))},y.prototype.each_sender=function(t,e){this.each_link(h.sender_filter(e))},y.prototype.each_link=function(t,e){for(var n in this.links){var r=this.links[n];(void 0===e||e(r))&&t(r)}},y.prototype.create_link=function(t,e,n){for(var r=0;this.local.handles[r];)r++;var i=new e(this,t,r,n);return this.links[t]=i,this.local.handles[r]=i,i},y.prototype.begin=function(){this.state.open()&&this.connection._register()},y.prototype.open=y.prototype.begin,y.prototype.end=function(t){t&&(this.local.end.error=t),this.state.close()&&this.connection._register()},y.prototype.close=y.prototype.end,y.prototype.is_open=function(){return this.connection.is_open()&&this.state.is_open()},y.prototype.is_remote_open=function(){return this.connection.is_remote_open()&&this.state.remote_open},y.prototype.is_closed=function(){return this.connection.is_closed()||this.state.is_closed()},y.prototype._process=function(){do{for(var t in this.state.need_open()&&this.output(this.local.begin),this.outgoing.process(),this.incoming.process(this),this.links)this.links[t]._process();this.state.need_close()&&this.output(this.local.end)}while(!this.state.has_settled())},y.prototype.send=function(t,e,n,r){var i=this.outgoing.send(t,e,n,r);return this.connection._register(),i},y.prototype._write_flow=function(t){var e={next_incoming_id:this.incoming.next_transfer_id,incoming_window:this.incoming.window,next_outgoing_id:this.outgoing.next_transfer_id,outgoing_window:this.outgoing.window};this.incoming.max_transfer_id=e.next_incoming_id+e.incoming_window,t&&(t._get_drain()&&(e.drain=!0),e.delivery_count=t.delivery_count,e.handle=t.local.handle,e.link_credit=t.credit),this.output(i.flow(e))},y.prototype.on_begin=function(t){if(!this.state.remote_opened())throw Error("Begin already received");this.remote.channel||(this.remote.channel=t.channel),this.remote.begin=t.performative,this.outgoing.on_begin(t.performative),this.incoming.on_begin(t.performative),this.open(),this.dispatch("session_open",this._context())},y.prototype.on_end=function(t){if(!this.state.remote_closed())throw Error("End already received");this.remote.end=t.performative,this.close();var e=this.remote.end.error;if(e){var n=this.dispatch("session_error",this._context());(n=this.dispatch("session_close",this._context())||n)||l.prototype.emit.call(this.connection.container,"error",new f(e.description,e.condition,this))}else this.dispatch("session_close",this._context())},y.prototype.on_attach=function(t){var e=t.performative.name,n=this.links[e];n||(n=t.performative.role?this.create_sender(e):this.create_receiver(e)),this.remote.handles[t.performative.handle]=n,n.on_attach(t),n.remote.attach=t.performative},y.prototype.on_disposition=function(t){t.performative.role?(s.events("Received disposition for outgoing transfers"),this.outgoing.on_disposition(t.performative)):(s.events("Received disposition for incoming transfers"),this.incoming.on_disposition(t.performative)),this.connection._register()},y.prototype.on_flow=function(t){this.outgoing.on_flow(t.performative),this.incoming.on_flow(t.performative),h.is_defined(t.performative.handle)&&this._get_link(t).on_flow(t),this.connection._register()},y.prototype._context=function(t){var e=t||{};return e.session=this,this.connection._context(e)},y.prototype._get_link=function(t){var e=t.performative.handle,n=this.remote.handles[e];if(!n)throw Error("Invalid handle "+e);return n},y.prototype.on_detach=function(t){this._get_link(t).on_detach(t);var e=t.performative.handle,n=this.remote.handles[e];delete this.remote.handles[e],delete this.local.handles[n.local.handle],delete this.links[n.name]},y.prototype.remove_link=function(t){delete this.remote.handles[t.remote.handle],delete this.local.handles[t.local.handle],delete this.links[t.name]},y.prototype.remove=function(){this.connection.remove_session(this)},y.prototype.on_transfer=function(t){this.incoming.on_transfer(t,this._get_link(t))},t.exports=y}).call(this,n(4),n(3).Buffer)},function(t,e,n){"use strict";(function(e,r){var i=n(16),o=n(14),s=n(23),a=n(62),c=n(22),h=function(t){this.window=t};function u(t){t.delivery.settled=!0}function l(t){t.delivery.update(void 0,s.accepted().described())}function f(t,e,n){Error.call(this),Error.captureStackTrace(this,this.constructor),this.message=t,this.condition=e,this.description=t,this.link=n}h.prototype.update=function(t){var e=this.window-t.receiver.credit;e>=this.window/4&&t.receiver.flow(e)},n(11).inherits(f,Error);var p=n(6).EventEmitter,d=Object.create(p.prototype);function _(t){switch(t){case"name":case"handle":case"role":case"initial_delivery_count":return!0;default:return!1}}d.dispatch=function(t){return o.events("Link got event: %s",t),p.prototype.emit.apply(this.observers,arguments),this.listeners(t).length?(p.prototype.emit.apply(this,arguments),!0):this.session.dispatch.apply(this.session,arguments)},d.set_source=function(t){this.local.attach.source=a.source(t).described()},d.set_target=function(t){this.local.attach.target=a.target(t).described()},d.attach=function(){this.state.open()&&this.connection._register()},d.open=d.attach,d.detach=function(){this.local.detach.closed=!1,this.state.close()&&this.connection._register()},d.close=function(t){t&&(this.local.detach.error=t),this.local.detach.closed=!0,this.state.close()&&this.connection._register()},d.remove=function(){this.session.remove_link(this)},d.is_open=function(){return this.session.is_open()&&this.state.is_open()},d.is_remote_open=function(){return this.session.is_remote_open()&&this.state.remote_open},d.is_closed=function(){return this.session.is_closed()||this.state.is_closed()},d._process=function(){do{this.state.need_open()&&this.session.output(this.local.attach),this.issue_flow&&(this.session._write_flow(this),this.issue_flow=!1),this.state.need_close()&&this.session.output(this.local.detach)}while(!this.state.has_settled())},d.on_attach=function(t){if(!this.state.remote_opened())throw Error("Attach already received");this.remote.handle||(this.remote.handle=t.handle),t.performative.source=a.unwrap(t.performative.source),t.performative.target=a.unwrap(t.performative.target),this.remote.attach=t.performative,this.open(),this.dispatch(this.is_receiver()?"receiver_open":"sender_open",this._context())},d.prefix_event=function(t){return(this.local.attach.role?"receiver_":"sender_")+t},d.on_detach=function(t){if(!this.state.remote_closed())throw Error("Detach already received");this.remote.detach=t.performative,this.close();var e=this.remote.detach.error;if(e){var n=this.dispatch(this.prefix_event("error"),this._context());(n=this.dispatch(this.prefix_event("close"),this._context())||n)||p.prototype.emit.call(this.connection.container,"error",new f(e.description,e.condition,this))}else this.dispatch(this.prefix_event("close"),this._context())};var m=["snd_settle_mode","rcv_settle_mode","source","target","max_message_size","offered_capabilities","desired_capabilities","properties"];function y(t){return function(){return this.remote.attach?this.remote.attach[t]:void 0}}d.init=function(t,e,n,r,o){for(var s in this.session=t,this.connection=t.connection,this.name=e,this.options=void 0===r?{}:r,this.state=new c,this.issue_flow=!1,this.local={handle:n},this.local.attach=i.attach({handle:n,name:e,role:o}),this.local.attach)_(s)||void 0===this.options[s]||(this.local.attach[s]=this.options[s]);for(var a in this.local.detach=i.detach({handle:n,closed:!0}),this.remote={handle:void 0},this.delivery_count=0,this.credit=0,this.observers=new p,m){var h=m[a];Object.defineProperty(this,h,{get:y(h)})}Object.defineProperty(this,"error",{get:function(){return this.remote.detach?this.remote.detach.error:void 0}})},d._disconnect=function(){this.state.disconnected()},d._reconnect=function(){this.state.reconnect(),this.remote={handle:void 0},this.delivery_count=0,this.credit=0},d.has_credit=function(){return this.credit>0},d.is_receiver=function(){return this.local.attach.role},d.is_sender=function(){return!this.is_receiver()},d._context=function(t){var e=t||{};return this.is_receiver()?e.receiver=this:e.sender=this,this.session._context(e)},d.get_option=function(t,e){return void 0!==this.options[t]?this.options[t]:this.session.get_option(t,e)};var g=function(t,e,n,r){this.init(t,e,n,r,!1),this._draining=!1,this._drained=!1,this.local.attach.initial_delivery_count=0,this.tag=0,this.get_option("autosettle",!0)&&this.observers.on("settled",u);var i=this;this.get_option("treat_modified_as_released",!0)&&this.observers.on("modified",function(t){i.dispatch("released",t)})};(g.prototype=Object.create(d)).constructor=g,g.prototype._get_drain=function(){if(this._draining&&this._drained&&this.credit){for(;this.credit;)++this.delivery_count,--this.credit;return!0}return!1},g.prototype.set_drained=function(t){this._drained=t,this._draining&&this._drained&&(this.issue_flow=!0)},g.prototype.next_tag=function(){return new e(new String(this.tag++))},g.prototype.sendable=function(){return Boolean(this.credit&&this.session.outgoing.available())},g.prototype.on_flow=function(t){var e=t.performative;this.credit=e.delivery_count+e.link_credit-this.delivery_count,this._draining=e.drain,this._drained=this.credit>0,this.is_open()&&(this.dispatch("sender_flow",this._context()),this._draining&&this.dispatch("sender_draining",this._context()),this.sendable()&&this.dispatch("sendable",this._context()))},g.prototype.on_transfer=function(){throw Error("got transfer on sending link")},g.prototype.send=function(t,e,n){var r=void 0===n?s.encode(t):t,i=this.session.send(this,e||this.next_tag(),r,n);return 1===this.local.attach.snd_settle_mode&&(i.settled=!0),i};var v=function(t,e,n,r){this.init(t,e,n,r,!0),this.drain=!1,this.set_credit_window(this.get_option("credit_window",1e3)),this.get_option("autoaccept",!0)&&this.observers.on("message",l)};(v.prototype=Object.create(d)).constructor=v,v.prototype.on_flow=function(t){this.dispatch("receiver_flow",this._context()),t.performative.drain&&(t.performative.link_credit>0?r.error("ERROR: received flow with drain set, but non zero credit"):this.dispatch("receiver_drained",this._context()))},v.prototype.flow=function(t){t>0&&(this.credit+=t,this.issue_flow=!0,this.connection._register())},v.prototype.add_credit=v.prototype.flow,v.prototype._get_drain=function(){return this.drain},v.prototype.set_credit_window=function(t){if(t>0){var e=new h(t),n=e.update.bind(e);this.observers.on("message",n),this.observers.on("receiver_open",n)}},t.exports={Sender:g,Receiver:v}}).call(this,n(3).Buffer,n(4))},function(t,e,n){"use strict";(function(e){var r=n(13),i={},o={};function s(t){var e=r.define_composite(t);i[t.name]=e.create,o[Number(e.descriptor.numeric).toString(10)]=e,o[e.descriptor.symbolic]=e}i.unwrap=function(t){if(t&&t.descriptor){var n=o[t.descriptor.value];if(n)return new n(t.value);e.warn("Unknown terminus: "+t.descriptor)}return null},s({name:"source",code:40,fields:[{name:"address",type:"string"},{name:"durable",type:"uint",default_value:0},{name:"expiry_policy",type:"symbol",default_value:"session-end"},{name:"timeout",type:"uint",default_value:0},{name:"dynamic",type:"boolean",default_value:!1},{name:"dynamic_node_properties",type:"symbolic_map"},{name:"distribution_mode",type:"symbol"},{name:"filter",type:"symbolic_map"},{name:"default_outcome",type:"*"},{name:"outcomes",type:"symbol",multiple:!0},{name:"capabilities",type:"symbol",multiple:!0}]}),s({name:"target",code:41,fields:[{name:"address",type:"string"},{name:"durable",type:"uint",default_value:0},{name:"expiry_policy",type:"symbol",default_value:"session-end"},{name:"timeout",type:"uint",default_value:0},{name:"dynamic",type:"boolean",default_value:!1},{name:"dynamic_node_properties",type:"symbolic_map"},{name:"capabilities",type:"symbol",multiple:!0}]}),t.exports=i}).call(this,n(4))},function(t,e,n){"use strict";(function(e){var r=n(24),i={counter:1,next:function(){return this.counter++}},o=function(t,e){var n=r.parse(e);this.connection=t.connect({host:n.hostname,port:n.port}),this.connection.on("message",this._response.bind(this)),this.connection.on("receiver_open",this._ready.bind(this)),this.sender=this.connection.attach_sender(n.path.substr(1)),this.receiver=this.connection.attach_receiver({source:{dynamic:!0}}),this.id_generator=i,this.pending=[],this.outstanding={}};o.prototype._request=function(t,e,n,r){var i={};i.subject=e,i.body=n,i.message_id=t,i.reply_to=this.receiver.remote.attach.source.address,this.outstanding[t]=r,this.sender.send(i)},o.prototype._response=function(t){var n=t.message.correlation_id,r=this.outstanding[n];r?"ok"===t.message.subject?r(t.message.body):r(void 0,{name:t.message.subject,description:t.message.body}):e.error("no request pending for "+n+", ignoring response")},o.prototype._ready=function(){this._process_pending()},o.prototype._process_pending=function(){for(var t=0;t<this.pending.length;t++){var e=this.pending[t];this._request(e.id,e.name,e.args,e.callback)}this.pending=[]},o.prototype.call=function(t,e,n){var r=this.id_generator.next();this.receiver.is_open()&&0===this.pending.length?this._request(r,t,e,n):this.pending.push({name:t,args:e,callback:n,id:r})},o.prototype.close=function(){this.receiver.close(),this.sender.close(),this.connection.close()},o.prototype.define=function(t){this[t]=function(e,n){this.call(t,e,n)}};var s=function(t,e){this.ttl=t,this.purged=e,this.entries={},this.timeout=void 0};s.prototype.clear=function(){this.timeout&&clearTimeout(this.timeout),this.entries={}},s.prototype.put=function(t,e){this.entries[t]={value:e,last_accessed:Date.now()},this.timeout||(this.timeout=setTimeout(this.purge.bind(this),this.ttl))},s.prototype.get=function(t){var e=this.entries[t];return e?(e.last_accessed=Date.now(),e.value):void 0},s.prototype.purge=function(){var t=Date.now(),e=[],n=0;for(var r in this.entries)t-this.entries[r].last_accessed>=this.ttl?e.push(r):n++;for(var i=0;i<e.length;i++){var o=this.entries[e[i]];delete this.entries[e[i]],this.purged(o.value)}n&&!this.timeout&&(this.timeout=setTimeout(this.purge.bind(this),this.ttl))};var a=function(t,e){this.factory=t,this.cache=new s(e,function(t){t.close()})};a.prototype.clear=function(){this.cache.clear()},a.prototype.get=function(t){var e=this.cache.get(t);return void 0===e&&(e=this.factory(t),this.cache.put(t,e)),e};var c=function(t,e,n){this.options=n||{};var i=r.parse(e);this.connection=t.connect({host:i.hostname,port:i.port}),this.connection.on("connection_open",this._connection_open.bind(this)),this.connection.on("message",this._request.bind(this)),this.receiver=this.connection.attach_receiver(i.path.substr(1)),this.callbacks={},this._send=void 0,this._clear=void 0};c.prototype._connection_open=function(){if(function(t,e){return!!e&&(Array.isArray(e)?e.indexOf(t)>-1:t===e)}("ANONYMOUS-RELAY",this.connection.remote.open.offered_capabilities)){var t=this.connection.attach_sender({target:{}});this._send=function(e){t.send(e)}}else{var e=new a(this.connection.attach_sender.bind(this.connection),this.options.cache_ttl||6e4);this._send=function(t){var n=e.get(t.to);n&&n.send(t)},this._clear=function(){e.clear()}}},c.prototype._respond=function(t){var e=this;return function(n,r){r?(t.subject=r.name||"error",t.body=r.description||r):(t.subject="ok",t.body=n),e._send(t)}},c.prototype._request=function(t){var e=t.message,n={};n.to=e.reply_to,n.correlation_id=e.message_id;var r=this.callbacks[e.subject];r?r(e.body,this._respond(n)):(n.subject="bad-method",n.body="Unrecognised method "+e.subject,this._send(n))},c.prototype.bind_sync=function(t,e){this.callbacks[e||t.name]=function(e,n){n(t(e))}},c.prototype.bind=function(t,e){this.callbacks[e||t.name]=t},c.prototype.close=function(){this._clear&&this._clear(),this.receiver.close(),this.connection.close()},t.exports={server:function(t,e,n){return new c(t,e,n)},client:function(t,e){return new o(t,e)}}}).call(this,n(4))},function(t,e,n){(function(t,r){var i;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(o){"object"==typeof e&&e&&e.nodeType,"object"==typeof t&&t&&t.nodeType;var s="object"==typeof r&&r;s.global!==s&&s.window!==s&&s.self;var a,c=2147483647,h=36,u=1,l=26,f=38,p=700,d=72,_=128,m="-",y=/^xn--/,g=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=h-u,E=Math.floor,S=String.fromCharCode;function k(t){throw new RangeError(b[t])}function x(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function I(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+x((t=t.replace(v,".")).split("."),e).join(".")}function A(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function T(t){return x(t,function(t){var e="";return t>65535&&(e+=S((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=S(t)}).join("")}function C(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:h}function O(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function U(t,e,n){var r=0;for(t=n?E(t/p):t>>1,t+=E(t/e);t>w*l>>1;r+=h)t=E(t/w);return E(r+(w+1)*t/(t+f))}function P(t){var e,n,r,i,o,s,a,f,p,y,g=[],v=t.length,b=0,w=_,S=d;for((n=t.lastIndexOf(m))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&k("not-basic"),g.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<v;){for(o=b,s=1,a=h;i>=v&&k("invalid-input"),((f=C(t.charCodeAt(i++)))>=h||f>E((c-b)/s))&&k("overflow"),b+=f*s,!(f<(p=a<=S?u:a>=S+l?l:a-S));a+=h)s>E(c/(y=h-p))&&k("overflow"),s*=y;S=U(b-o,e=g.length+1,0==o),E(b/e)>c-w&&k("overflow"),w+=E(b/e),b%=e,g.splice(b++,0,w)}return T(g)}function R(t){var e,n,r,i,o,s,a,f,p,y,g,v,b,w,x,I=[];for(v=(t=A(t)).length,e=_,n=0,o=d,s=0;s<v;++s)(g=t[s])<128&&I.push(S(g));for(r=i=I.length,i&&I.push(m);r<v;){for(a=c,s=0;s<v;++s)(g=t[s])>=e&&g<a&&(a=g);for(a-e>E((c-n)/(b=r+1))&&k("overflow"),n+=(a-e)*b,e=a,s=0;s<v;++s)if((g=t[s])<e&&++n>c&&k("overflow"),g==e){for(f=n,p=h;!(f<(y=p<=o?u:p>=o+l?l:p-o));p+=h)x=f-y,w=h-y,I.push(S(O(y+x%w,0))),f=E(x/w);I.push(S(O(f,0))),o=U(n,b,r==i),n=0,++r}++n,++e}return I.join("")}a={version:"1.4.1",ucs2:{decode:A,encode:T},decode:P,encode:R,toASCII:function(t){return I(t,function(t){return g.test(t)?"xn--"+R(t):t})},toUnicode:function(t){return I(t,function(t){return y.test(t)?P(t.slice(4).toLowerCase()):t})}},void 0===(i=function(){return a}.call(e,n,e,t))||(t.exports=i)}()}).call(this,n(65)(t),n(5))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";e.decode=e.parse=n(68),e.encode=e.stringify=n(69)},function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var h=t.length;c>0&&h>c&&(h=c);for(var u=0;u<h;++u){var l,f,p,d,_=t[u].replace(a,"%20"),m=_.indexOf(n);m>=0?(l=_.substr(0,m),f=_.substr(m+1)):(l=_,f=""),p=decodeURIComponent(l),d=decodeURIComponent(f),r(s,p)?i(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?o(s(t),function(s){var a=encodeURIComponent(r(s))+n;return i(t[s])?o(t[s],function(t){return a+encodeURIComponent(r(t))}).join(e):a+encodeURIComponent(r(t[s]))}).join(e):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e,n){"use strict";var r,i,o,s;!function(t){t.message="message",t.receiverOpen="receiver_open",t.receiverDrained="receiver_drained",t.receiverFlow="receiver_flow",t.receiverError="receiver_error",t.receiverClose="receiver_close",t.settled="settled"}(r||(r={})),function(t){t.sendable="sendable",t.senderOpen="sender_open",t.senderDraining="sender_draining",t.senderFlow="sender_flow",t.senderError="sender_error",t.senderClose="sender_close",t.accepted="accepted",t.released="released",t.rejected="rejected",t.modified="modified",t.settled="settled"}(i||(i={})),function(t){t.sessionOpen="session_open",t.sessionError="session_error",t.sessionClose="session_close",t.settled="settled"}(o||(o={})),function(t){t.connectionOpen="connection_open",t.connectionClose="connection_close",t.connectionError="connection_error",t.protocolError="protocol_error",t.error="error",t.disconnected="disconnected",t.settled="settled"}(s||(s={})),t.exports={ReceiverEvents:r,SenderEvents:i,SessionEvents:o,ConnectionEvents:s}},function(t,e,n){"use strict";(function(e,n){function r(t){return t}function i(t){return t instanceof ArrayBuffer?new e(new Uint8Array(t)):new e(t)}function o(t){return new Uint8Array(t)}function s(t){var e=r,s=r;return t.binaryType&&(t.binaryType="arraybuffer",e=i,s=o),{end:function(){t.close()},write:function(e){try{t.send(s(e),{binary:!0})}catch(e){t.onerror(e)}},on:function(r,i){"data"===r?t.onmessage=function(t){i(e(t.data))}:"end"===r?t.onclose=i:"error"===r?t.onerror=i:n.error("ERROR: Attempt to set unrecognised handler on websocket wrapper: "+r)},get_id_string:function(){return t.url}}}t.exports={connect:function(t){return function(e,n,r){return function(){return{connect:function(i,o,a,c){var h=new t(e,n,r);return h.onopen=c,s(h)}}}}},wrap:s}}).call(this,n(3).Buffer,n(4))},function(t,e,n){"use strict";var r=n(13);t.exports={selector:function(t){return{"jms-selector":r.wrap_described(t,77567109365764)}}}},function(t,e,n){"use strict";var r=n(0),i=n(1).Buffer,o=n(32),s=i.alloc(128),a=64;function c(t,e){o.call(this,"digest"),"string"==typeof e&&(e=i.from(e)),this._alg=t,this._key=e,e.length>a?e=t(e):e.length<a&&(e=i.concat([e,s],a));for(var n=this._ipad=i.allocUnsafe(a),r=this._opad=i.allocUnsafe(a),c=0;c<a;c++)n[c]=54^e[c],r[c]=92^e[c];this._hash=[n]}r(c,o),c.prototype._update=function(t){this._hash.push(t)},c.prototype._final=function(){var t=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,t]))},t.exports=c},function(t,e){},function(t,e,n){"use strict";var r=n(1).Buffer,i=n(76);function o(t,e,n){t.copy(e,n)}t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e=r.allocUnsafe(t>>>0),n=this.head,i=0;n;)o(n.data,e,i),i+=n.data.length,n=n.next;return e},t}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(78),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(5))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i=1,o={},s=!1,a=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){u(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&u(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),r=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){u(t.data)},r=function(e){t.port2.postMessage(e)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var t=a.documentElement;r=function(e){var n=a.createElement("script");n.onreadystatechange=function(){u(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():r=function(t){setTimeout(u,0,t)},c.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var s={callback:t,args:e};return o[i]=s,r(i),i++},c.clearImmediate=h}function h(t){delete o[t]}function u(t){if(s)setTimeout(u,0,t);else{var e=o[t];if(e){s=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{h(t),s=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(5),n(2))},function(t,e,n){(function(e,n){function r(t){try{if(!n.localStorage)return!1}catch(t){return!1}var e=n.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}t.exports=function(t,n){if(r("noDeprecation"))return t;var i=!1;return function(){if(!i){if(r("throwDeprecation"))throw new Error(n);r("traceDeprecation")?e.trace(n):e.warn(n),i=!0}return t.apply(this,arguments)}}}).call(this,n(4),n(5))},function(t,e,n){"use strict";t.exports=o;var r=n(37),i=n(18);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t)}i.inherits=n(0),i.inherits(o,r),o.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){t.exports=n(25)},function(t,e,n){t.exports=n(9).Transform},function(t,e,n){t.exports=n(9).PassThrough},function(t,e,n){var r=n(85);t.exports=function(t){return(new r).update(t).digest()}},function(t,e,n){"use strict";(function(e){var r=n(0),i=n(39),o=new Array(16);function s(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function a(t,e){return t<<e|t>>>32-e}function c(t,e,n,r,i,o,s){return a(t+(e&n|~e&r)+i+o|0,s)+e|0}function h(t,e,n,r,i,o,s){return a(t+(e&r|n&~r)+i+o|0,s)+e|0}function u(t,e,n,r,i,o,s){return a(t+(e^n^r)+i+o|0,s)+e|0}function l(t,e,n,r,i,o,s){return a(t+(n^(e|~r))+i+o|0,s)+e|0}r(s,i),s.prototype._update=function(){for(var t=o,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);var n=this._a,r=this._b,i=this._c,s=this._d;r=l(r=l(r=l(r=l(r=u(r=u(r=u(r=u(r=h(r=h(r=h(r=h(r=c(r=c(r=c(r=c(r,i=c(i,s=c(s,n=c(n,r,i,s,t[0],3614090360,7),r,i,t[1],3905402710,12),n,r,t[2],606105819,17),s,n,t[3],3250441966,22),i=c(i,s=c(s,n=c(n,r,i,s,t[4],4118548399,7),r,i,t[5],1200080426,12),n,r,t[6],2821735955,17),s,n,t[7],4249261313,22),i=c(i,s=c(s,n=c(n,r,i,s,t[8],1770035416,7),r,i,t[9],2336552879,12),n,r,t[10],4294925233,17),s,n,t[11],2304563134,22),i=c(i,s=c(s,n=c(n,r,i,s,t[12],1804603682,7),r,i,t[13],4254626195,12),n,r,t[14],2792965006,17),s,n,t[15],1236535329,22),i=h(i,s=h(s,n=h(n,r,i,s,t[1],4129170786,5),r,i,t[6],3225465664,9),n,r,t[11],643717713,14),s,n,t[0],3921069994,20),i=h(i,s=h(s,n=h(n,r,i,s,t[5],3593408605,5),r,i,t[10],38016083,9),n,r,t[15],3634488961,14),s,n,t[4],3889429448,20),i=h(i,s=h(s,n=h(n,r,i,s,t[9],568446438,5),r,i,t[14],3275163606,9),n,r,t[3],4107603335,14),s,n,t[8],1163531501,20),i=h(i,s=h(s,n=h(n,r,i,s,t[13],2850285829,5),r,i,t[2],4243563512,9),n,r,t[7],1735328473,14),s,n,t[12],2368359562,20),i=u(i,s=u(s,n=u(n,r,i,s,t[5],4294588738,4),r,i,t[8],2272392833,11),n,r,t[11],1839030562,16),s,n,t[14],4259657740,23),i=u(i,s=u(s,n=u(n,r,i,s,t[1],2763975236,4),r,i,t[4],1272893353,11),n,r,t[7],4139469664,16),s,n,t[10],3200236656,23),i=u(i,s=u(s,n=u(n,r,i,s,t[13],681279174,4),r,i,t[0],3936430074,11),n,r,t[3],3572445317,16),s,n,t[6],76029189,23),i=u(i,s=u(s,n=u(n,r,i,s,t[9],3654602809,4),r,i,t[12],3873151461,11),n,r,t[15],530742520,16),s,n,t[2],3299628645,23),i=l(i,s=l(s,n=l(n,r,i,s,t[0],4096336452,6),r,i,t[7],1126891415,10),n,r,t[14],2878612391,15),s,n,t[5],4237533241,21),i=l(i,s=l(s,n=l(n,r,i,s,t[12],1700485571,6),r,i,t[3],2399980690,10),n,r,t[10],4293915773,15),s,n,t[1],2240044497,21),i=l(i,s=l(s,n=l(n,r,i,s,t[8],1873313359,6),r,i,t[15],4264355552,10),n,r,t[6],2734768916,15),s,n,t[13],1309151649,21),i=l(i,s=l(s,n=l(n,r,i,s,t[4],4149444226,6),r,i,t[11],3174756917,10),n,r,t[2],718787259,15),s,n,t[9],3951481745,21),this._a=this._a+n|0,this._b=this._b+r|0,this._c=this._c+i|0,this._d=this._d+s|0},s.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=new e(16);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t},t.exports=s}).call(this,n(3).Buffer)},function(t,e,n){"use strict";var r=n(3).Buffer,i=n(0),o=n(39),s=new Array(16),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],c=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],h=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],u=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],l=[0,1518500249,1859775393,2400959708,2840853838],f=[1352829926,1548603684,1836072691,2053994217,0];function p(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function d(t,e){return t<<e|t>>>32-e}function _(t,e,n,r,i,o,s,a){return d(t+(e^n^r)+o+s|0,a)+i|0}function m(t,e,n,r,i,o,s,a){return d(t+(e&n|~e&r)+o+s|0,a)+i|0}function y(t,e,n,r,i,o,s,a){return d(t+((e|~n)^r)+o+s|0,a)+i|0}function g(t,e,n,r,i,o,s,a){return d(t+(e&r|n&~r)+o+s|0,a)+i|0}function v(t,e,n,r,i,o,s,a){return d(t+(e^(n|~r))+o+s|0,a)+i|0}i(p,o),p.prototype._update=function(){for(var t=s,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);for(var n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,p=0|this._e,b=0|this._a,w=0|this._b,E=0|this._c,S=0|this._d,k=0|this._e,x=0;x<80;x+=1){var I,A;x<16?(I=_(n,r,i,o,p,t[a[x]],l[0],h[x]),A=v(b,w,E,S,k,t[c[x]],f[0],u[x])):x<32?(I=m(n,r,i,o,p,t[a[x]],l[1],h[x]),A=g(b,w,E,S,k,t[c[x]],f[1],u[x])):x<48?(I=y(n,r,i,o,p,t[a[x]],l[2],h[x]),A=y(b,w,E,S,k,t[c[x]],f[2],u[x])):x<64?(I=g(n,r,i,o,p,t[a[x]],l[3],h[x]),A=m(b,w,E,S,k,t[c[x]],f[3],u[x])):(I=v(n,r,i,o,p,t[a[x]],l[4],h[x]),A=_(b,w,E,S,k,t[c[x]],f[4],u[x])),n=p,p=o,o=d(i,10),i=r,r=I,b=k,k=S,S=d(E,10),E=w,w=A}var T=this._b+i+S|0;this._b=this._c+o+k|0,this._c=this._d+p+b|0,this._d=this._e+n+w|0,this._e=this._a+r+E|0,this._a=T},p.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=r.alloc?r.alloc(20):new r(20);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t.writeInt32LE(this._e,16),t},t.exports=p},function(t,e,n){(e=t.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n}).sha=n(88),e.sha1=n(89),e.sha224=n(90),e.sha256=n(40),e.sha384=n(91),e.sha512=n(41)},function(t,e,n){var r=n(0),i=n(15),o=n(1).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function c(){this.init(),this._w=a,i.call(this,64,56)}function h(t){return t<<5|t>>>27}function u(t){return t<<30|t>>>2}function l(t,e,n,r){return 0===t?e&n|~e&r:2===t?e&n|e&r|n&r:e^n^r}r(c,i),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(t){for(var e=this._w,n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,a=0|this._e,c=0;c<16;++c)e[c]=t.readInt32BE(4*c);for(;c<80;++c)e[c]=e[c-3]^e[c-8]^e[c-14]^e[c-16];for(var f=0;f<80;++f){var p=~~(f/20),d=h(n)+l(p,r,i,o)+a+e[f]+s[p]|0;a=o,o=i,i=u(r),r=n,n=d}this._a=n+this._a|0,this._b=r+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=a+this._e|0},c.prototype._hash=function(){var t=o.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=c},function(t,e,n){var r=n(0),i=n(15),o=n(1).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function c(){this.init(),this._w=a,i.call(this,64,56)}function h(t){return t<<1|t>>>31}function u(t){return t<<5|t>>>27}function l(t){return t<<30|t>>>2}function f(t,e,n,r){return 0===t?e&n|~e&r:2===t?e&n|e&r|n&r:e^n^r}r(c,i),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(t){for(var e=this._w,n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,a=0|this._e,c=0;c<16;++c)e[c]=t.readInt32BE(4*c);for(;c<80;++c)e[c]=h(e[c-3]^e[c-8]^e[c-14]^e[c-16]);for(var p=0;p<80;++p){var d=~~(p/20),_=u(n)+f(d,r,i,o)+a+e[p]+s[d]|0;a=o,o=i,i=l(r),r=n,n=_}this._a=n+this._a|0,this._b=r+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=a+this._e|0},c.prototype._hash=function(){var t=o.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=c},function(t,e,n){var r=n(0),i=n(40),o=n(15),s=n(1).Buffer,a=new Array(64);function c(){this.init(),this._w=a,o.call(this,64,56)}r(c,i),c.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},c.prototype._hash=function(){var t=s.allocUnsafe(28);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t},t.exports=c},function(t,e,n){var r=n(0),i=n(41),o=n(15),s=n(1).Buffer,a=new Array(160);function c(){this.init(),this._w=a,o.call(this,128,112)}r(c,i),c.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},c.prototype._hash=function(){var t=s.allocUnsafe(48);function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t},t.exports=c},function(t,e,n){"use strict";(function(e,r){var i=n(6),o=n(42),s=n(43),a=n(95),c=n(9).Writable,h=n(0),u=n(101),l=n(102),f=n(27),p=e.setImmediate||function(t){r.nextTick(t)},d={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0};function _(t,e,n){t.emit("packetsend",e),!a.writeToStream(e,t.stream)&&n?t.stream.once("drain",n):n&&n()}function m(){}function y(t,e){var n,r=this;if(!(this instanceof y))return new y(t,e);for(n in this.options=e||{},d)void 0===this.options[n]?this.options[n]=d[n]:this.options[n]=e[n];this.options.clientId="string"==typeof this.options.clientId?this.options.clientId:"mqttjs_"+Math.random().toString(16).substr(2,8),this.streamBuilder=t,this.outgoingStore=this.options.outgoingStore||new o,this.incomingStore=this.options.incomingStore||new o,this.queueQoSZero=void 0===this.options.queueQoSZero||this.options.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this.nextId=Math.max(1,Math.floor(65535*Math.random())),this.outgoing={},this.on("connect",function(){if(!this.disconnected){this.connected=!0;var t=null;(t=this.outgoingStore.createStream()).once("readable",function(){!function e(){var n,i=t.read(1);i&&(!r.disconnecting&&!r.reconnectTimer&&r.options.reconnectPeriod>0?(t.read(0),n=r.outgoing[i.messageId],r.outgoing[i.messageId]=function(t,r){n&&n(t,r),e()},r._sendPacket(i)):t.destroy&&t.destroy())}()}).on("error",this.emit.bind(this,"error"))}}),this.on("close",function(){this.connected=!1,clearTimeout(this.connackTimer)}),this.on("connect",this._setupPingTimer),this.on("connect",function(){var t=this.queue;!function e(){var n,i=t.shift();i&&(n=i.packet,r._sendPacket(n,function(t){i.cb&&i.cb(t),e()}))}()});var s=!0;this.on("connect",function(){!s&&this.options.clean&&Object.keys(this._resubscribeTopics).length>0&&(this.options.resubscribe?(this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics)):this._resubscribeTopics={}),s=!1}),this.on("close",function(){null!==r.pingTimer&&(r.pingTimer.clear(),r.pingTimer=null)}),this.on("close",this._setupReconnect),i.EventEmitter.call(this),this._setupStream()}h(y,i.EventEmitter),y.prototype._setupStream=function(){var t,e=this,n=new c,i=a.parser(this.options),o=null,h=[];function u(){r.nextTick(l)}function l(){var t=h.shift(),n=o;t?e._handlePacket(t,u):(o=null,n())}this._clearReconnect(),this.stream=this.streamBuilder(this),i.on("packet",function(t){h.push(t)}),n._write=function(t,e,n){o=n,i.parse(t),l()},this.stream.pipe(n),this.stream.on("error",m),s(this.stream,this.emit.bind(this,"close")),(t=Object.create(this.options)).cmd="connect",_(this,t),i.on("error",this.emit.bind(this,"error")),this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(function(){e._cleanUp(!0)},this.options.connectTimeout)},y.prototype._handlePacket=function(t,e){switch(this.emit("packetreceive",t),t.cmd){case"publish":this._handlePublish(t,e);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":this._handleAck(t),e();break;case"pubrel":this._handlePubrel(t,e);break;case"connack":this._handleConnack(t),e();break;case"pingresp":this._handlePingresp(t),e()}},y.prototype._checkDisconnecting=function(t){return this.disconnecting&&(t?t(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting},y.prototype.publish=function(t,e,n,r){var i;"function"==typeof n&&(r=n,n=null);if(n=f({qos:0,retain:!1,dup:!1},n),this._checkDisconnecting(r))return this;switch(i={cmd:"publish",topic:t,payload:e,qos:n.qos,retain:n.retain,messageId:this._nextId(),dup:n.dup},n.qos){case 1:case 2:this.outgoing[i.messageId]=r||m,this._sendPacket(i);break;default:this._sendPacket(i,r)}return this},y.prototype.subscribe=function(){var t,e,n=Array.prototype.slice.call(arguments),r=[],i=n.shift(),o=i.resubscribe,s=n.pop()||m,a=n.pop(),c=this;if(delete i.resubscribe,"string"==typeof i&&(i=[i]),"function"!=typeof s&&(a=s,s=m),null!==(e=l.validateTopics(i)))return p(s,new Error("Invalid topic "+e)),this;if(this._checkDisconnecting(s))return this;if(a=f({qos:0},a),Array.isArray(i)?i.forEach(function(t){(c._resubscribeTopics[t]<a.qos||!c._resubscribeTopics.hasOwnProperty(t)||o)&&r.push({topic:t,qos:a.qos})}):Object.keys(i).forEach(function(t){(c._resubscribeTopics[t]<i[t]||!c._resubscribeTopics.hasOwnProperty(t)||o)&&r.push({topic:t,qos:i[t]})}),t={cmd:"subscribe",subscriptions:r,qos:1,retain:!1,dup:!1,messageId:this._nextId()},r.length){if(this.options.resubscribe){var h=[];r.forEach(function(t){c.options.reconnectPeriod>0&&(c._resubscribeTopics[t.topic]=t.qos,h.push(t.topic))}),c.messageIdToTopic[t.messageId]=h}return this.outgoing[t.messageId]=function(t,e){if(!t)for(var n=e.granted,i=0;i<n.length;i+=1)r[i].qos=n[i];s(t,r)},this._sendPacket(t),this}s(null,[])},y.prototype.unsubscribe=function(t,e){var n={cmd:"unsubscribe",qos:1,messageId:this._nextId()},r=this;return e=e||m,this._checkDisconnecting(e)?this:("string"==typeof t?n.unsubscriptions=[t]:"object"==typeof t&&t.length&&(n.unsubscriptions=t),this.options.resubscribe&&n.unsubscriptions.forEach(function(t){delete r._resubscribeTopics[t]}),this.outgoing[n.messageId]=e,this._sendPacket(n),this)},y.prototype.end=function(t,e){var n=this;function r(){n.disconnected=!0,n.incomingStore.close(function(){n.outgoingStore.close(function(){e&&e.apply(null,arguments),n.emit("end")})}),n._deferredReconnect&&n._deferredReconnect()}function i(){n._cleanUp(t,p.bind(null,r))}return"function"==typeof t&&(e=t,t=!1),this.disconnecting?this:(this._clearReconnect(),this.disconnecting=!0,!t&&Object.keys(this.outgoing).length>0?this.once("outgoingEmpty",setTimeout.bind(null,i,10)):i(),this)},y.prototype.removeOutgoingMessage=function(t){var e=this.outgoing[t];return delete this.outgoing[t],this.outgoingStore.del({messageId:t},function(){e(new Error("Message removed"))}),this},y.prototype.reconnect=function(t){var e=this,n=function(){t?(e.options.incomingStore=t.incomingStore,e.options.outgoingStore=t.outgoingStore):(e.options.incomingStore=null,e.options.outgoingStore=null),e.incomingStore=e.options.incomingStore||new o,e.outgoingStore=e.options.outgoingStore||new o,e.disconnecting=!1,e.disconnected=!1,e._deferredReconnect=null,e._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=n:n(),this},y.prototype._reconnect=function(){this.emit("reconnect"),this._setupStream()},y.prototype._setupReconnect=function(){var t=this;!t.disconnecting&&!t.reconnectTimer&&t.options.reconnectPeriod>0&&(this.reconnecting||(this.emit("offline"),this.reconnecting=!0),t.reconnectTimer=setInterval(function(){t._reconnect()},t.options.reconnectPeriod))},y.prototype._clearReconnect=function(){this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)},y.prototype._cleanUp=function(t,e){e&&this.stream.on("close",e),t?(0===this.options.reconnectPeriod&&this.options.clean&&function(t){t&&Object.keys(t).forEach(function(e){"function"==typeof t[e]&&(t[e](new Error("Connection closed")),delete t[e])})}(this.outgoing),this.stream.destroy()):this._sendPacket({cmd:"disconnect"},p.bind(null,this.stream.end.bind(this.stream))),this.disconnecting||(this._clearReconnect(),this._setupReconnect()),null!==this.pingTimer&&(this.pingTimer.clear(),this.pingTimer=null),e&&!this.connected&&(this.stream.removeListener("close",e),e())},y.prototype._sendPacket=function(t,e){if(this.connected)if(this._shiftPingInterval(),"publish"===t.cmd)switch(t.qos){case 2:case 1:!function(t,e,n){t.outgoingStore.put(e,function(r){if(r)return n&&n(r);_(t,e,n)})}(this,t,e);break;case 0:default:_(this,t,e)}else _(this,t,e);else 0===(t.qos||0)&&this.queueQoSZero||"publish"!==t.cmd?this.queue.push({packet:t,cb:e}):t.qos>0?(e=this.outgoing[t.messageId],this.outgoingStore.put(t,function(t){if(t)return e&&e(t)})):e&&e(new Error("No connection to broker"))},y.prototype._setupPingTimer=function(){var t=this;!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=u(function(){t._checkPing()},1e3*this.options.keepalive))},y.prototype._shiftPingInterval=function(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)},y.prototype._checkPing=function(){this.pingResp?(this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):this._cleanUp(!0)},y.prototype._handlePingresp=function(){this.pingResp=!0},y.prototype._handleConnack=function(t){var e=t.returnCode;if(clearTimeout(this.connackTimer),0===e)this.reconnecting=!1,this.emit("connect",t);else if(e>0){var n=new Error("Connection refused: "+["","Unacceptable protocol version","Identifier rejected","Server unavailable","Bad username or password","Not authorized"][e]);n.code=e,this.emit("error",n)}},y.prototype._handlePublish=function(t,e){var n=t.topic.toString(),r=t.payload,i=t.qos,o=t.messageId,s=this;switch(i){case 2:this.incomingStore.put(t,function(){s._sendPacket({cmd:"pubrec",messageId:o},e)});break;case 1:this.emit("message",n,r,t),this.handleMessage(t,function(t){if(t)return e&&e(t);s._sendPacket({cmd:"puback",messageId:o},e)});break;case 0:this.emit("message",n,r,t),this.handleMessage(t,e)}},y.prototype.handleMessage=function(t,e){e()},y.prototype._handleAck=function(t){var e=t.messageId,n=t.cmd,r=null,i=this.outgoing[e],o=this;if(i){switch(n){case"pubcomp":case"puback":delete this.outgoing[e],this.outgoingStore.del(t,i);break;case"pubrec":r={cmd:"pubrel",qos:2,messageId:e},this._sendPacket(r);break;case"suback":if(delete this.outgoing[e],1===t.granted.length&&0!=(128&t.granted[0])){var s=this.messageIdToTopic[e];s&&s.forEach(function(t){delete o._resubscribeTopics[t]})}i(null,t);break;case"unsuback":delete this.outgoing[e],i(null);break;default:o.emit("error",new Error("unrecognized packet type"))}this.disconnecting&&0===Object.keys(this.outgoing).length&&this.emit("outgoingEmpty")}},y.prototype._handlePubrel=function(t,e){var n=this,r={cmd:"pubcomp",messageId:t.messageId};n.incomingStore.get(t,function(i,o){i||"pubrel"===o.cmd?n._sendPacket(r,e):(n.emit("message",o.topic,o.payload,o),n.incomingStore.put(t),n.handleMessage(o,function(t){if(t)return e&&e(t);n._sendPacket(r,e)}))})},y.prototype._nextId=function(){var t=this.nextId++;return 65536===this.nextId&&(this.nextId=1),t},y.prototype.getLastMessageId=function(){return 1===this.nextId?65535:this.nextId-1},t.exports=y}).call(this,n(5),n(2))},function(t,e,n){var r=n(94);function i(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function o(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},n=t.name||"Function wrapped with `once`";return e.onceError=n+" shouldn't be called more than once",e.called=!1,e}t.exports=r(i),t.exports.strict=r(o),i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},function(t,e){t.exports=function t(e,n){if(e&&n)return t(e)(n);if("function"!=typeof e)throw new TypeError("need wrapper function");Object.keys(e).forEach(function(t){r[t]=e[t]});return r;function r(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];var r=e.apply(this,t),i=t[t.length-1];return"function"==typeof r&&r!==i&&Object.keys(i).forEach(function(t){r[t]=i[t]}),r}}},function(t,e,n){"use strict";e.parser=n(96),e.generate=n(99),e.writeToStream=n(45)},function(t,e,n){"use strict";var r=n(97),i=n(0),o=n(6).EventEmitter,s=n(98),a=n(44);function c(){if(!(this instanceof c))return new c;this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState()}i(c,o),c.prototype._resetState=function(){this.packet=new s,this.error=null,this._list=r(),this._stateCounter=0},c.prototype.parse=function(t){for(this.error&&this._resetState(),this._list.append(t);(-1!==this.packet.length||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,this._stateCounter>=this._states.length&&(this._stateCounter=0);return this._list.length},c.prototype._parseHeader=function(){var t=this._list.readUInt8(0);return this.packet.cmd=a.types[t>>a.CMD_SHIFT],this.packet.retain=0!=(t&a.RETAIN_MASK),this.packet.qos=t>>a.QOS_SHIFT&a.QOS_MASK,this.packet.dup=0!=(t&a.DUP_MASK),this._list.consume(1),!0},c.prototype._parseLength=function(){for(var t,e=0,n=1,r=0,i=!0;e<5&&(r+=n*((t=this._list.readUInt8(e++))&a.LENGTH_MASK),n*=128,0!=(t&a.LENGTH_FIN_MASK));)if(this._list.length<=e){i=!1;break}return i&&(this.packet.length=r,this._list.consume(e)),i},c.prototype._parsePayload=function(){var t=!1;if(0===this.packet.length||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseMessageId();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":case"disconnect":break;default:this._emitError(new Error("Not supported"))}t=!0}return t},c.prototype._parseConnect=function(){var t,e,n,r,i,o,s={},c=this.packet;if(null===(t=this._parseString()))return this._emitError(new Error("Cannot parse protocolId"));if("MQTT"!==t&&"MQIsdp"!==t)return this._emitError(new Error("Invalid protocolId"));if(c.protocolId=t,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(c.protocolVersion=this._list.readUInt8(this._pos),3!==c.protocolVersion&&4!==c.protocolVersion)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(s.username=this._list.readUInt8(this._pos)&a.USERNAME_MASK,s.password=this._list.readUInt8(this._pos)&a.PASSWORD_MASK,s.will=this._list.readUInt8(this._pos)&a.WILL_FLAG_MASK,s.will&&(c.will={},c.will.retain=0!=(this._list.readUInt8(this._pos)&a.WILL_RETAIN_MASK),c.will.qos=(this._list.readUInt8(this._pos)&a.WILL_QOS_MASK)>>a.WILL_QOS_SHIFT),c.clean=0!=(this._list.readUInt8(this._pos)&a.CLEAN_SESSION_MASK),this._pos++,c.keepalive=this._parseNum(),-1===c.keepalive)return this._emitError(new Error("Packet too short"));if(null===(e=this._parseString()))return this._emitError(new Error("Packet too short"));if(c.clientId=e,s.will){if(null===(n=this._parseString()))return this._emitError(new Error("Cannot parse will topic"));if(c.will.topic=n,null===(r=this._parseBuffer()))return this._emitError(new Error("Cannot parse will payload"));c.will.payload=r}if(s.username){if(null===(o=this._parseString()))return this._emitError(new Error("Cannot parse username"));c.username=o}if(s.password){if(null===(i=this._parseBuffer()))return this._emitError(new Error("Cannot parse password"));c.password=i}return c},c.prototype._parseConnack=function(){var t=this.packet;return this._list.length<2?null:(t.sessionPresent=!!(this._list.readUInt8(this._pos++)&a.SESSIONPRESENT_MASK),t.returnCode=this._list.readUInt8(this._pos),-1===t.returnCode?this._emitError(new Error("Cannot parse return code")):void 0)},c.prototype._parsePublish=function(){var t=this.packet;if(t.topic=this._parseString(),null===t.topic)return this._emitError(new Error("Cannot parse topic"));t.qos>0&&!this._parseMessageId()||(t.payload=this._list.slice(this._pos,t.length))},c.prototype._parseSubscribe=function(){var t,e,n=this.packet;if(1!==n.qos)return this._emitError(new Error("Wrong subscribe header"));if(n.subscriptions=[],this._parseMessageId())for(;this._pos<n.length;){if(null===(t=this._parseString()))return this._emitError(new Error("Cannot parse topic"));e=this._list.readUInt8(this._pos++),n.subscriptions.push({topic:t,qos:e})}},c.prototype._parseSuback=function(){if(this.packet.granted=[],this._parseMessageId())for(;this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))},c.prototype._parseUnsubscribe=function(){var t=this.packet;if(t.unsubscriptions=[],this._parseMessageId())for(;this._pos<t.length;){var e;if(null===(e=this._parseString()))return this._emitError(new Error("Cannot parse topic"));t.unsubscriptions.push(e)}},c.prototype._parseUnsuback=function(){if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"))},c.prototype._parseMessageId=function(){var t=this.packet;return t.messageId=this._parseNum(),null!==t.messageId||(this._emitError(new Error("Cannot parse messageId")),!1)},c.prototype._parseString=function(t){var e,n=this._parseNum(),r=n+this._pos;return-1===n||r>this._list.length||r>this.packet.length?null:(e=this._list.toString("utf8",this._pos,r),this._pos+=n,e)},c.prototype._parseBuffer=function(){var t,e=this._parseNum(),n=e+this._pos;return-1===e||n>this._list.length||n>this.packet.length?null:(t=this._list.slice(this._pos,n),this._pos+=e,t)},c.prototype._parseNum=function(){if(this._list.length-this._pos<2)return-1;var t=this._list.readUInt16BE(this._pos);return this._pos+=2,t},c.prototype._newPacket=function(){return this.packet&&(this._list.consume(this.packet.length),this.emit("packet",this.packet)),this.packet=new s,!0},c.prototype._emitError=function(t){this.error=t,this.emit("error",t)},t.exports=c},function(t,e,n){var r=n(38),i=n(11),o=n(1).Buffer;function s(t){if(!(this instanceof s))return new s(t);if(this._bufs=[],this.length=0,"function"==typeof t){this._callback=t;var e=function(t){this._callback&&(this._callback(t),this._callback=null)}.bind(this);this.on("pipe",function(t){t.on("error",e)}),this.on("unpipe",function(t){t.removeListener("error",e)})}else this.append(t);r.call(this)}i.inherits(s,r),s.prototype._offset=function(t){var e,n=0,r=0;if(0===t)return[0,0];for(;r<this._bufs.length;r++){if(t<(e=n+this._bufs[r].length)||r==this._bufs.length-1)return[r,t-n];n=e}},s.prototype.append=function(t){var e=0;if(o.isBuffer(t))this._appendBuffer(t);else if(Array.isArray(t))for(;e<t.length;e++)this.append(t[e]);else if(t instanceof s)for(;e<t._bufs.length;e++)this.append(t._bufs[e]);else null!=t&&("number"==typeof t&&(t=t.toString()),this._appendBuffer(o.from(t)));return this},s.prototype._appendBuffer=function(t){this._bufs.push(t),this.length+=t.length},s.prototype._write=function(t,e,n){this._appendBuffer(t),"function"==typeof n&&n()},s.prototype._read=function(t){if(!this.length)return this.push(null);t=Math.min(t,this.length),this.push(this.slice(0,t)),this.consume(t)},s.prototype.end=function(t){r.prototype.end.call(this,t),this._callback&&(this._callback(null,this.slice()),this._callback=null)},s.prototype.get=function(t){return this.slice(t,t+1)[0]},s.prototype.slice=function(t,e){return"number"==typeof t&&t<0&&(t+=this.length),"number"==typeof e&&e<0&&(e+=this.length),this.copy(null,0,t,e)},s.prototype.copy=function(t,e,n,r){if(("number"!=typeof n||n<0)&&(n=0),("number"!=typeof r||r>this.length)&&(r=this.length),n>=this.length)return t||o.alloc(0);if(r<=0)return t||o.alloc(0);var i,s,a=!!t,c=this._offset(n),h=r-n,u=h,l=a&&e||0,f=c[1];if(0===n&&r==this.length){if(!a)return 1===this._bufs.length?this._bufs[0]:o.concat(this._bufs,this.length);for(s=0;s<this._bufs.length;s++)this._bufs[s].copy(t,l),l+=this._bufs[s].length;return t}if(u<=this._bufs[c[0]].length-f)return a?this._bufs[c[0]].copy(t,e,f,f+u):this._bufs[c[0]].slice(f,f+u);for(a||(t=o.allocUnsafe(h)),s=c[0];s<this._bufs.length;s++){if(!(u>(i=this._bufs[s].length-f))){this._bufs[s].copy(t,l,f,f+u);break}this._bufs[s].copy(t,l,f),l+=i,u-=i,f&&(f=0)}return t},s.prototype.shallowSlice=function(t,e){t=t||0,e=e||this.length,t<0&&(t+=this.length),e<0&&(e+=this.length);var n=this._offset(t),r=this._offset(e),i=this._bufs.slice(n[0],r[0]+1);return 0==r[1]?i.pop():i[i.length-1]=i[i.length-1].slice(0,r[1]),0!=n[1]&&(i[0]=i[0].slice(n[1])),new s(i)},s.prototype.toString=function(t,e,n){return this.slice(e,n).toString(t)},s.prototype.consume=function(t){for(;this._bufs.length;){if(!(t>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(t),this.length-=t;break}t-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},s.prototype.duplicate=function(){for(var t=0,e=new s;t<this._bufs.length;t++)e.append(this._bufs[t]);return e},s.prototype.destroy=function(){this._bufs.length=0,this.length=0,this.push(null)},function(){var t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};for(var e in t)!function(e){s.prototype[e]=function(n){return this.slice(n,n+t[e])[e](0)}}(e)}(),t.exports=s},function(t,e){t.exports=function(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}},function(t,e,n){"use strict";var r=n(1).Buffer,i=n(45),o=n(6).EventEmitter;function s(){this._array=new Array(20),this._i=0}n(0)(s,o),s.prototype.write=function(t){return this._array[this._i++]=t,!0},s.prototype.concat=function(){var t,e,n=0,i=new Array(this._array.length),o=this._array,s=0;for(t=0;t<o.length&&void 0!==o[t];t++)"string"!=typeof o[t]?i[t]=o[t].length:i[t]=r.byteLength(o[t]),n+=i[t];for(e=r.allocUnsafe(n),t=0;t<o.length&&void 0!==o[t];t++)"string"!=typeof o[t]?(o[t].copy(e,s),s+=i[t]):(e.write(o[t],s),s+=i[t]);return e},t.exports=function(t){var e=new s;return i(t,e),e.concat()}},function(t,e,n){"use strict";var r=n(1).Buffer,i=65536,o={};function s(t){var e=r.allocUnsafe(2);return e.writeUInt8(t>>8,0),e.writeUInt8(255&t,1),e}t.exports={cache:o,generateCache:function(){for(var t=0;t<i;t++)o[t]=s(t)},generateNumber:s}},function(t,e,n){"use strict";t.exports=function(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("interval needed");var t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new function(t,e,n){var r=this;this._callback=t,this._args=n,this._interval=setInterval(t,e,this._args),this.reschedule=function(t){t||(t=r._interval),r._interval&&clearInterval(r._interval),r._interval=setInterval(r._callback,t,r._args)},this.clear=function(){r._interval&&(clearInterval(r._interval),r._interval=void 0)},this.destroy=function(){r._interval&&clearInterval(r._interval),r._callback=void 0,r._interval=void 0,r._args=void 0}}(arguments[0],arguments[1],t)}},function(t,e,n){"use strict";function r(t){for(var e=t.split("/"),n=0;n<e.length;n++)if("+"!==e[n]){if("#"===e[n])return n===e.length-1;if(-1!==e[n].indexOf("+")||-1!==e[n].indexOf("#"))return!1}return!0}t.exports={validateTopics:function(t){if(0===t.length)return"empty_topic_list";for(var e=0;e<t.length;e++)if(!r(t[e]))return t[e];return null}}},function(t,e){},function(t,e){},function(t,e,n){(function(e,r){var i=n(9),o=n(43),s=n(0),a=n(106),c=e.from&&e.from!==Uint8Array.from?e.from([0]):new e([0]),h=function(t,e){t._corked?t.once("uncork",e):e()},u=function(t,e){return function(n){n?function(t,e){t._autoDestroy&&t.destroy(e)}(t,"premature close"===n.message?null:n):e&&!t._ended&&t.end()}},l=function(t,e,n){if(!(this instanceof l))return new l(t,e,n);i.Duplex.call(this,n),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!n||!1!==n.autoDestroy,this._forwardDestroy=!n||!1!==n.destroy,this._forwardEnd=!n||!1!==n.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,t&&this.setWritable(t),e&&this.setReadable(e)};s(l,i.Duplex),l.obj=function(t,e,n){return n||(n={}),n.objectMode=!0,n.highWaterMark=16,new l(t,e,n)},l.prototype.cork=function(){1==++this._corked&&this.emit("cork")},l.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},l.prototype.setWritable=function(t){if(this._unwrite&&this._unwrite(),this.destroyed)t&&t.destroy&&t.destroy();else if(null!==t&&!1!==t){var e=this,n=o(t,{writable:!0,readable:!1},u(this,this._forwardEnd)),i=function(){var t=e._ondrain;e._ondrain=null,t&&t()};this._unwrite&&r.nextTick(i),this._writable=t,this._writable.on("drain",i),this._unwrite=function(){e._writable.removeListener("drain",i),n()},this.uncork()}else this.end()},l.prototype.setReadable=function(t){if(this._unread&&this._unread(),this.destroyed)t&&t.destroy&&t.destroy();else{if(null===t||!1===t)return this.push(null),void this.resume();var e=this,n=o(t,{writable:!1,readable:!0},u(this)),r=function(){e._forward()},s=function(){e.push(null)};this._drained=!0,this._readable=t,this._readable2=t._readableState?t:function(t){return new i.Readable({objectMode:!0,highWaterMark:16}).wrap(t)}(t),this._readable2.on("readable",r),this._readable2.on("end",s),this._unread=function(){e._readable2.removeListener("readable",r),e._readable2.removeListener("end",s),n()},this._forward()}},l.prototype._read=function(){this._drained=!0,this._forward()},l.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var t;for(this._forwarding=!0;this._drained&&null!==(t=a(this._readable2));)this.destroyed||(this._drained=this.push(t));this._forwarding=!1}},l.prototype.destroy=function(t){if(!this.destroyed){this.destroyed=!0;var e=this;r.nextTick(function(){e._destroy(t)})}},l.prototype._destroy=function(t){if(t){var e=this._ondrain;this._ondrain=null,e?e(t):this.emit("error",t)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},l.prototype._write=function(t,e,n){return this.destroyed?n():this._corked?h(this,this._write.bind(this,t,e,n)):t===c?this._finish(n):this._writable?void(!1===this._writable.write(t)?this._ondrain=n:n()):n()},l.prototype._finish=function(t){var e=this;this.emit("preend"),h(this,function(){!function(t,e){t?t._writableState&&t._writableState.finished?e():t._writableState?t.end(e):(t.end(),e()):e()}(e._forwardEnd&&e._writable,function(){!1===e._writableState.prefinished&&(e._writableState.prefinished=!0),e.emit("prefinish"),h(e,t)})})},l.prototype.end=function(t,e,n){return"function"==typeof t?this.end(null,null,t):"function"==typeof e?this.end(t,null,e):(this._ended=!0,t&&this.write(t),this._writableState.ending||this.write(c),i.Writable.prototype.end.call(this,n))},t.exports=l}).call(this,n(3).Buffer,n(2))},function(t,e){t.exports=function(t){var e=t._readableState;return e?e.objectMode?t.read():t.read(function(t){return t.buffer.length?t.buffer.head?t.buffer.head.data.length:t.buffer[0].length:t.length}(e)):null}},function(t,e){var n=null;"undefined"!=typeof WebSocket?n=WebSocket:"undefined"!=typeof MozWebSocket?n=MozWebSocket:"undefined"!=typeof window&&(n=window.WebSocket||window.MozWebSocket),t.exports=n},function(t,e,n){"use strict";n.r(e);var r=n(8),i=n.n(r),o=n(7),s=n(19),a=n.n(s);const c=a()("monitor-events");function h(t,e,n){const r=Object(o.e)(e),s=Object(o.b)(r.Endpoint),a=r.SharedAccessKeyName,h=r.SharedAccessKey,u=`wss://${s}:443/$servicebus/websocket?iothub-no-client-cert=true`,l=i.a.websocket_connect(WebSocket),f=i.a.connect({hostname:s,container_id:"conn"+Date.now(),max_frame_size:4294967295,channel_max:65535,idle_timeout:12e4,outgoing_locales:"en-US",incoming_locales:"en-US",offered_capabilities:null,desired_capabilities:null,properties:{},connection_details:l(u,["AMQPWSB10"]),reconnect:!1,username:a,password:h});let p;i.a.on("connection_open",function(t){f.open_receiver("$management"),p=f.open_sender("$management")}),i.a.once("sendable",function(e){p.send({body:"[]",application_properties:{operation:"READ",name:t,type:"com.microsoft:eventhub"}})});const d=`amqp.annotation.x-opt-enqueuedtimeutc > '${Date.now()}'`;return i.a.once("message",function(t){c("monitoring from eventhub endpoint on iothub ..."),t.message.body.partition_ids.forEach(t=>{f.attach_receiver((t=>({desired_capabilities:"com.microsoft:enable-receiver-runtime-metric",autoaccept:!0,source:{address:"hao-gl-iothub/ConsumerGroups/$default/Partitions/"+t,filter:{"apache.org:selector-filter:string":i.a.types.wrap_described(d,77567109365764)}}}))(t))}),i.a.on("message",t=>{c(t),n(t.message.body.content.toString(),t)})}),{close:f.close.bind(f)}}var u=n(51);const l=a()("device");function f(t,e){const n=Object(o.d)(60),r=Object(o.e)(t),i=r.HostName,s=r.SharedAccessKey,a=r.DeviceId,c=Object(o.a)(`${i}/devices/${a}`,null,s,n),h=Object(o.c)(c),f={clean:!1,clientId:a,keepalive:180,password:h,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,rejectUnauthorized:!0,connectTimeout:3e4,reschedulePings:!0,username:`${i}/${a}/api-version=2017-06-30`},p=Object(u.connect)(`wss://${i}:443/$iothub/websocket?iothub-no-client-cert=true`,f);p.on("connect",function(){l("emitter connected!")}),p.on("offline",function(){l("emitter offline")}),p.on("close",function(){l("emitter closed!")}),p.on("message",e),p.on("packetsend",()=>{l("trying to send pocket..")}),p.subscribe(`devices/${a}/messages/devicebound/#`,{qos:0});return{publish:(t,e={})=>{const n=Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t])).join("&");p.publish(`devices/${a}/messages/events/${n}`,t,{qos:1,retain:!1})},close:p.end.bind(p)}}n.d(e,"monitorEvents",function(){return h}),n.d(e,"connectDevice",function(){return f})}])});